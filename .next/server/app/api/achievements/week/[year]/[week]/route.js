"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/achievements/week/[year]/[week]/route";
exports.ids = ["app/api/achievements/week/[year]/[week]/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "sqlite3":
/*!**************************!*\
  !*** external "sqlite3" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("sqlite3");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&page=%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute.ts&appDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&page=%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute.ts&appDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_DY0330_ENG_Desktop_project_giji_20250526_PMESYSTEM_app_api_achievements_week_year_week_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/achievements/week/[year]/[week]/route.ts */ \"(rsc)/./app/api/achievements/week/[year]/[week]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/achievements/week/[year]/[week]/route\",\n        pathname: \"/api/achievements/week/[year]/[week]\",\n        filename: \"route\",\n        bundlePath: \"app/api/achievements/week/[year]/[week]/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\DY0330.ENG\\\\Desktop\\\\project_giji\\\\20250526\\\\PMESYSTEM\\\\app\\\\api\\\\achievements\\\\week\\\\[year]\\\\[week]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_DY0330_ENG_Desktop_project_giji_20250526_PMESYSTEM_app_api_achievements_week_year_week_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/achievements/week/[year]/[week]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhY2hpZXZlbWVudHMlMkZ3ZWVrJTJGJTVCeWVhciU1RCUyRiU1QndlZWslNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFjaGlldmVtZW50cyUyRndlZWslMkYlNUJ5ZWFyJTVEJTJGJTVCd2VlayU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFjaGlldmVtZW50cyUyRndlZWslMkYlNUJ5ZWFyJTVEJTJGJTVCd2VlayU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNEWTAzMzAuRU5HJTVDRGVza3RvcCU1Q3Byb2plY3RfZ2lqaSU1QzIwMjUwNTI2JTVDUE1FU1lTVEVNJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNEWTAzMzAuRU5HJTVDRGVza3RvcCU1Q3Byb2plY3RfZ2lqaSU1QzIwMjUwNTI2JTVDUE1FU1lTVEVNJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUN5RTtBQUN0SjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL3BtZS1zeXN0ZW0tdjAuMDFwcm9qZWN0Lz9mMjlmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXERZMDMzMC5FTkdcXFxcRGVza3RvcFxcXFxwcm9qZWN0X2dpamlcXFxcMjAyNTA1MjZcXFxcUE1FU1lTVEVNXFxcXGFwcFxcXFxhcGlcXFxcYWNoaWV2ZW1lbnRzXFxcXHdlZWtcXFxcW3llYXJdXFxcXFt3ZWVrXVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWNoaWV2ZW1lbnRzL3dlZWsvW3llYXJdL1t3ZWVrXS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2FjaGlldmVtZW50cy93ZWVrL1t5ZWFyXS9bd2Vla11cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FjaGlldmVtZW50cy93ZWVrL1t5ZWFyXS9bd2Vla10vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxEWTAzMzAuRU5HXFxcXERlc2t0b3BcXFxccHJvamVjdF9naWppXFxcXDIwMjUwNTI2XFxcXFBNRVNZU1RFTVxcXFxhcHBcXFxcYXBpXFxcXGFjaGlldmVtZW50c1xcXFx3ZWVrXFxcXFt5ZWFyXVxcXFxbd2Vla11cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FjaGlldmVtZW50cy93ZWVrL1t5ZWFyXS9bd2Vla10vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&page=%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute.ts&appDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/achievements/week/[year]/[week]/route.ts":
/*!**********************************************************!*\
  !*** ./app/api/achievements/week/[year]/[week]/route.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   runtime: () => (/* binding */ runtime)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db_utils */ \"(rsc)/./lib/db_utils.ts\");\n\n\nconst runtime = \"nodejs\";\nasync function GET(request, { params }) {\n    try {\n        console.log(\"週データ取得API: GET リクエスト受信\");\n        const year = params.year;\n        const week = params.week;\n        console.log(`週データ取得API: パラメータ - 年=${year}, 週=${week}`);\n        const yearNum = Number.parseInt(year);\n        const weekNum = Number.parseInt(week);\n        if (isNaN(yearNum) || isNaN(weekNum) || weekNum < 1 || weekNum > 53) {\n            console.error(`週データ取得API: 無効なパラメータ - 年=${year}, 週=${week}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                message: \"無効な年または週が指定されました\"\n            }, {\n                status: 400\n            });\n        }\n        console.log(`週データ取得API: データベースからデータを取得中...`);\n        const achievements = await (0,_lib_db_utils__WEBPACK_IMPORTED_MODULE_1__.getAchievementsByWeek)(yearNum, weekNum);\n        console.log(`週データ取得API: ${achievements.length}件のデータを取得しました`);\n        // 取得したデータの一部をログに出力して確認\n        if (achievements.length > 0) {\n            console.log(\"週データ取得API: 最初のデータのサンプル:\", {\n                keyID: achievements[0].keyID,\n                businessCode: achievements[0].businessCode,\n                departmentCode: achievements[0].departmentCode,\n                classification5: achievements[0].classification5,\n                classification6: achievements[0].classification6,\n                classification7: achievements[0].classification7\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: achievements\n        });\n    } catch (error) {\n        console.error(\"週データ取得API: エラー発生\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            message: \"実績データの取得中にエラーが発生しました\",\n            error: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n// POST関数も同様に修正\nasync function POST(request, { params }) {\n    try {\n        console.log(\"週データ保存API: POST リクエスト受信\");\n        const year = params.year;\n        const week = params.week;\n        console.log(`週データ保存API: パラメータ - 年=${year}, 週=${week}`);\n        const yearNum = Number.parseInt(year);\n        const weekNum = Number.parseInt(week);\n        if (isNaN(yearNum) || isNaN(weekNum) || weekNum < 1 || weekNum > 53) {\n            console.error(`週データ保存API: 無効なパラメータ - 年=${year}, 週=${week}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                message: \"無効な年または週が指定されました\"\n            }, {\n                status: 400\n            });\n        }\n        const body = await request.json();\n        const events = body.events;\n        if (!Array.isArray(events)) {\n            console.error(\"週データ保存API: イベントデータが配列ではありません\");\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                message: \"イベントデータが正しくありません\"\n            }, {\n                status: 400\n            });\n        }\n        // 保存前にいくつかのイベントのbusinessCodeとdepartmentCodeをログに出力\n        if (events.length > 0) {\n            console.log(\"週データ保存API: 保存するイベントのサンプル:\", events.slice(0, 3).map((e)=>({\n                    keyID: e.keyID,\n                    activityCode: e.activityCode,\n                    businessCode: e.businessCode,\n                    departmentCode: e.departmentCode,\n                    classification5: e.classification5,\n                    classification6: e.classification6,\n                    classification7: e.classification7\n                })));\n        }\n        console.log(`週データ保存API: ${events.length}件のイベントを保存します`);\n        const updatedEvents = await (0,_lib_db_utils__WEBPACK_IMPORTED_MODULE_1__.withTransaction)(async (db)=>{\n            const { startDate, endDate } = getWeekDates(yearNum, weekNum);\n            const startDateStr = formatDate(startDate) + \" 00:00:00\";\n            const endDateStr = formatDate(new Date(endDate.getTime() + 86400000)) + \" 00:00:00\";\n            // 現在のユーザーIDを取得\n            const currentUserId = await (0,_lib_db_utils__WEBPACK_IMPORTED_MODULE_1__.getCurrentUserId)();\n            console.log(\"週データ保存API: 現在のユーザーID:\", currentUserId);\n            // 現在のユーザーの週データのみを取得\n            const existingEvents = await db.all(\"SELECT keyID FROM main_Zisseki WHERE startDateTime >= ? AND startDateTime < ? AND employeeNumber = ?\", [\n                startDateStr,\n                endDateStr,\n                currentUserId\n            ]);\n            console.log(\"週データ保存API: クライアントから受信したイベント:\", events.map((e)=>({\n                    id: e.id,\n                    keyID: e.keyID,\n                    employeeNumber: e.employeeNumber\n                })));\n            console.log(\"週データ保存API: データベースの既存イベント:\", existingEvents);\n            // 型を適用 - keyIDを優先的に使用\n            const eventIds = events.filter((e)=>e.keyID || e.id).map((e)=>e.keyID || e.id);\n            console.log(\"週データ保存API: クライアント側のイベントID:\", eventIds);\n            // 現在のユーザーのイベントのみを削除対象にする\n            const idsToDelete = existingEvents.map((e)=>e.keyID).filter((id)=>!eventIds.includes(id));\n            console.log(\"週データ保存API: 削除対象のイベントID:\", idsToDelete);\n            console.log(\"週データ保存API: 保存対象のイベントID:\", eventIds);\n            if (idsToDelete.length > 0) {\n                const placeholders = idsToDelete.map(()=>\"?\").join(\",\");\n                await db.run(`DELETE FROM main_Zisseki WHERE keyID IN (${placeholders})`, idsToDelete);\n                console.log(`週データ保存API: ${idsToDelete.length}件のイベントを削除しました`);\n            }\n            const updatedEventIds = [];\n            for (const event of events){\n                // keyIDを優先的に使用\n                const eventKeyID = event.keyID || event.id;\n                console.log(\"週データ保存API: 処理中のイベント:\", eventKeyID, \"employeeNumber:\", event.employeeNumber);\n                // IDが既に存在するかチェック\n                const existing = await db.get(\"SELECT keyID FROM main_Zisseki WHERE keyID = ?\", [\n                    eventKeyID\n                ]);\n                if (existing) {\n                    console.log(\"週データ保存API: UPDATE対象:\", eventKeyID);\n                    console.log(\"週データ保存API: 更新データ:\", {\n                        classification5: event.classification5,\n                        activityCode: event.activityCode\n                    });\n                    const columns = Object.keys(event).filter((k)=>k !== \"keyID\" && k !== \"id\");\n                    const setClause = columns.map((c)=>`${c} = ?`).join(\",\");\n                    const values = [\n                        ...columns.map((c)=>event[c]),\n                        eventKeyID\n                    ];\n                    await db.run(`UPDATE main_Zisseki SET ${setClause} WHERE keyID = ?`, values);\n                    updatedEventIds.push({\n                        oldId: event.oldId,\n                        newId: eventKeyID\n                    });\n                } else {\n                    console.log(\"週データ保存API: INSERT対象:\", eventKeyID);\n                    // idとkeyIDの両方を除外し、keyIDのみを使用\n                    const filteredEvent = {\n                        ...event\n                    };\n                    if (filteredEvent.id) delete filteredEvent.id;\n                    const columns = Object.keys(filteredEvent);\n                    const placeholders = columns.map(()=>\"?\").join(\",\");\n                    const values = columns.map((c)=>filteredEvent[c]);\n                    await db.run(`INSERT INTO main_Zisseki (${columns.join(\",\")}) VALUES (${placeholders})`, values);\n                    if (event.oldId) {\n                        updatedEventIds.push({\n                            oldId: event.oldId,\n                            newId: eventKeyID\n                        });\n                    }\n                }\n            }\n            console.log(`週データ保存API: 処理完了 - ${updatedEventIds.length}件のイベントIDを更新しました`);\n            return updatedEventIds;\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"週データが正常に保存されました\",\n            updatedEvents: updatedEvents\n        });\n    } catch (error) {\n        console.error(\"週データ保存API: エラー発生\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            message: \"週データの保存中にエラーが発生しました\",\n            error: String(error)\n        }, {\n            status: 500\n        });\n    }\n}\n// 補助関数\nfunction getWeekDates(year, week) {\n    const firstDayOfYear = new Date(year, 0, 1);\n    const daysOffset = firstDayOfYear.getDay() === 0 ? 6 : firstDayOfYear.getDay() - 1;\n    const firstWeekDay = new Date(year, 0, 1 + (week - 1) * 7 - daysOffset);\n    const startDate = new Date(firstWeekDay);\n    startDate.setDate(firstWeekDay.getDate() - firstWeekDay.getDay());\n    const endDate = new Date(startDate);\n    endDate.setDate(startDate.getDate() + 6);\n    return {\n        startDate,\n        endDate\n    };\n}\nfunction formatDate(date) {\n    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, \"0\")}-${date.getDate().toString().padStart(2, \"0\")}`;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FjaGlldmVtZW50cy93ZWVrL1t5ZWFyXS9bd2Vla10vcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBMEM7QUFDK0M7QUFDbEYsTUFBTUksVUFBVSxTQUFRO0FBRXhCLGVBQWVDLElBQ3BCQyxPQUFnQixFQUNoQixFQUFFQyxNQUFNLEVBQThDO0lBRXRELElBQUk7UUFDRkMsUUFBUUMsR0FBRyxDQUFDO1FBRVosTUFBTUMsT0FBT0gsT0FBT0csSUFBSTtRQUN4QixNQUFNQyxPQUFPSixPQUFPSSxJQUFJO1FBRXhCSCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxxQkFBcUIsRUFBRUMsS0FBSyxJQUFJLEVBQUVDLEtBQUssQ0FBQztRQUVyRCxNQUFNQyxVQUFVQyxPQUFPQyxRQUFRLENBQUNKO1FBQ2hDLE1BQU1LLFVBQVVGLE9BQU9DLFFBQVEsQ0FBQ0g7UUFFaEMsSUFBSUssTUFBTUosWUFBWUksTUFBTUQsWUFBWUEsVUFBVSxLQUFLQSxVQUFVLElBQUk7WUFDbkVQLFFBQVFTLEtBQUssQ0FBQyxDQUFDLHdCQUF3QixFQUFFUCxLQUFLLElBQUksRUFBRUMsS0FBSyxDQUFDO1lBQzFELE9BQU9YLHFEQUFZQSxDQUFDa0IsSUFBSSxDQUFDO2dCQUFFQyxTQUFTO2dCQUFPQyxTQUFTO1lBQW1CLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUMxRjtRQUVBYixRQUFRQyxHQUFHLENBQUMsQ0FBQyw2QkFBNkIsQ0FBQztRQUMzQyxNQUFNYSxlQUFlLE1BQU1yQixvRUFBcUJBLENBQUNXLFNBQVNHO1FBQzFEUCxRQUFRQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUVhLGFBQWFDLE1BQU0sQ0FBQyxZQUFZLENBQUM7UUFFM0QsdUJBQXVCO1FBQ3ZCLElBQUlELGFBQWFDLE1BQU0sR0FBRyxHQUFHO1lBQzNCZixRQUFRQyxHQUFHLENBQUMsMkJBQTJCO2dCQUNyQ2UsT0FBT0YsWUFBWSxDQUFDLEVBQUUsQ0FBQ0UsS0FBSztnQkFDNUJDLGNB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QUFNQyxlQUFlLElBQUlqQyxLQUFLdkMsTUFBTSxHQUFHLElBQUksQ0FBQ0MsT0FBTyxLQUFLLElBQUlxRTtJQUM1RCxNQUFNckMsWUFBWSxJQUFJTSxLQUFLaUM7SUFDM0J2QyxVQUFVd0MsT0FBTyxDQUFDRCxhQUFhRSxPQUFPLEtBQUtGLGFBQWFELE1BQU07SUFDOUQsTUFBTXJDLFVBQVUsSUFBSUssS0FBS047SUFDekJDLFFBQVF1QyxPQUFPLENBQUN4QyxVQUFVeUMsT0FBTyxLQUFLO0lBQ3RDLE9BQU87UUFBRXpDO1FBQVdDO0lBQVE7QUFDOUI7QUFFQSxTQUFTRyxXQUFXc0MsSUFBVTtJQUM1QixPQUFPLENBQUMsRUFBRUEsS0FBS0MsV0FBVyxHQUFHLENBQUMsRUFBRSxDQUFDRCxLQUFLRSxRQUFRLEtBQUssR0FDaERDLFFBQVEsR0FDUkMsUUFBUSxDQUFDLEdBQUcsS0FBSyxDQUFDLEVBQUVKLEtBQUtELE9BQU8sR0FBR0ksUUFBUSxHQUFHQyxRQUFRLENBQUMsR0FBRyxLQUFLLENBQUM7QUFDckUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wbWUtc3lzdGVtLXYwLjAxcHJvamVjdC8uL2FwcC9hcGkvYWNoaWV2ZW1lbnRzL3dlZWsvW3llYXJdL1t3ZWVrXS9yb3V0ZS50cz8zMjIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiXG5pbXBvcnQgeyBnZXRBY2hpZXZlbWVudHNCeVdlZWssIHdpdGhUcmFuc2FjdGlvbiwgZ2V0Q3VycmVudFVzZXJJZCB9IGZyb20gXCJAL2xpYi9kYl91dGlsc1wiXG5leHBvcnQgY29uc3QgcnVudGltZSA9IFwibm9kZWpzXCJcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChcbiAgcmVxdWVzdDogUmVxdWVzdCwgXG4gIHsgcGFyYW1zIH06IHsgcGFyYW1zOiB7IHllYXI6IHN0cmluZzsgd2Vlazogc3RyaW5nIH0gfVxuKSB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCLpgLHjg4fjg7zjgr/lj5blvpdBUEk6IEdFVCDjg6rjgq/jgqjjgrnjg4jlj5fkv6FcIilcblxuICAgIGNvbnN0IHllYXIgPSBwYXJhbXMueWVhclxuICAgIGNvbnN0IHdlZWsgPSBwYXJhbXMud2Vla1xuXG4gICAgY29uc29sZS5sb2coYOmAseODh+ODvOOCv+WPluW+l0FQSTog44OR44Op44Oh44O844K/IC0g5bm0PSR7eWVhcn0sIOmAsT0ke3dlZWt9YClcblxuICAgIGNvbnN0IHllYXJOdW0gPSBOdW1iZXIucGFyc2VJbnQoeWVhcilcbiAgICBjb25zdCB3ZWVrTnVtID0gTnVtYmVyLnBhcnNlSW50KHdlZWspXG5cbiAgICBpZiAoaXNOYU4oeWVhck51bSkgfHwgaXNOYU4od2Vla051bSkgfHwgd2Vla051bSA8IDEgfHwgd2Vla051bSA+IDUzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDpgLHjg4fjg7zjgr/lj5blvpdBUEk6IOeEoeWKueOBquODkeODqeODoeODvOOCvyAtIOW5tD0ke3llYXJ9LCDpgLE9JHt3ZWVrfWApXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogXCLnhKHlirnjgarlubTjgb7jgZ/jga/pgLHjgYzmjIflrprjgZXjgozjgb7jgZfjgZ9cIiB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYOmAseODh+ODvOOCv+WPluW+l0FQSTog44OH44O844K/44OZ44O844K544GL44KJ44OH44O844K/44KS5Y+W5b6X5LitLi4uYClcbiAgICBjb25zdCBhY2hpZXZlbWVudHMgPSBhd2FpdCBnZXRBY2hpZXZlbWVudHNCeVdlZWsoeWVhck51bSwgd2Vla051bSlcbiAgICBjb25zb2xlLmxvZyhg6YCx44OH44O844K/5Y+W5b6XQVBJOiAke2FjaGlldmVtZW50cy5sZW5ndGh95Lu244Gu44OH44O844K/44KS5Y+W5b6X44GX44G+44GX44GfYClcblxuICAgIC8vIOWPluW+l+OBl+OBn+ODh+ODvOOCv+OBruS4gOmDqOOCkuODreOCsOOBq+WHuuWKm+OBl+OBpueiuuiqjVxuICAgIGlmIChhY2hpZXZlbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXCLpgLHjg4fjg7zjgr/lj5blvpdBUEk6IOacgOWIneOBruODh+ODvOOCv+OBruOCteODs+ODl+ODqzpcIiwge1xuICAgICAgICBrZXlJRDogYWNoaWV2ZW1lbnRzWzBdLmtleUlELFxuICAgICAgICBidXNpbmVzc0NvZGU6IGFjaGlldmVtZW50c1swXS5idXNpbmVzc0NvZGUsIC8vIGJ1c2luZXNzQ29kZeOCkuODreOCsOOBq+i/veWKoFxuICAgICAgICBkZXBhcnRtZW50Q29kZTogYWNoaWV2ZW1lbnRzWzBdLmRlcGFydG1lbnRDb2RlLCAvLyBkZXBhcnRtZW50Q29kZeOCkuODreOCsOOBq+i/veWKoFxuICAgICAgICBjbGFzc2lmaWNhdGlvbjU6IGFjaGlldmVtZW50c1swXS5jbGFzc2lmaWNhdGlvbjUsXG4gICAgICAgIGNsYXNzaWZpY2F0aW9uNjogYWNoaWV2ZW1lbnRzWzBdLmNsYXNzaWZpY2F0aW9uNixcbiAgICAgICAgY2xhc3NpZmljYXRpb243OiBhY2hpZXZlbWVudHNbMF0uY2xhc3NpZmljYXRpb243LFxuICAgICAgfSlcbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IGFjaGlldmVtZW50cyxcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLpgLHjg4fjg7zjgr/lj5blvpdBUEk6IOOCqOODqeODvOeZuueUn1wiLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiBcIuWun+e4vuODh+ODvOOCv+OBruWPluW+l+S4reOBq+OCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBn1wiLFxuICAgICAgICBlcnJvcjogU3RyaW5nKGVycm9yKSxcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH0sXG4gICAgKVxuICB9XG59XG5cbi8vIFBPU1TplqLmlbDjgoLlkIzmp5jjgavkv67mraNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKFxuICByZXF1ZXN0OiBSZXF1ZXN0LCBcbiAgeyBwYXJhbXMgfTogeyBwYXJhbXM6IHsgeWVhcjogc3RyaW5nOyB3ZWVrOiBzdHJpbmcgfSB9XG4pIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIumAseODh+ODvOOCv+S/neWtmEFQSTogUE9TVCDjg6rjgq/jgqjjgrnjg4jlj5fkv6FcIilcblxuICAgIGNvbnN0IHllYXIgPSBwYXJhbXMueWVhclxuICAgIGNvbnN0IHdlZWsgPSBwYXJhbXMud2Vla1xuXG4gICAgY29uc29sZS5sb2coYOmAseODh+ODvOOCv+S/neWtmEFQSTog44OR44Op44Oh44O844K/IC0g5bm0PSR7eWVhcn0sIOmAsT0ke3dlZWt9YClcblxuICAgIGNvbnN0IHllYXJOdW0gPSBOdW1iZXIucGFyc2VJbnQoeWVhcilcbiAgICBjb25zdCB3ZWVrTnVtID0gTnVtYmVyLnBhcnNlSW50KHdlZWspXG5cbiAgICBpZiAoaXNOYU4oeWVhck51bSkgfHwgaXNOYU4od2Vla051bSkgfHwgd2Vla051bSA8IDEgfHwgd2Vla051bSA+IDUzKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGDpgLHjg4fjg7zjgr/kv53lrZhBUEk6IOeEoeWKueOBquODkeODqeODoeODvOOCvyAtIOW5tD0ke3llYXJ9LCDpgLE9JHt3ZWVrfWApXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgbWVzc2FnZTogXCLnhKHlirnjgarlubTjgb7jgZ/jga/pgLHjgYzmjIflrprjgZXjgozjgb7jgZfjgZ9cIiB9LCB7IHN0YXR1czogNDAwIH0pXG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgZXZlbnRzID0gYm9keS5ldmVudHNcblxuICAgIGlmICghQXJyYXkuaXNBcnJheShldmVudHMpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDjgqTjg5njg7Pjg4jjg4fjg7zjgr/jgYzphY3liJfjgafjga/jgYLjgorjgb7jgZvjgpNcIilcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiBcIuOCpOODmeODs+ODiOODh+ODvOOCv+OBjOato+OBl+OBj+OBguOCiuOBvuOBm+OCk1wiIH0sIHsgc3RhdHVzOiA0MDAgfSlcbiAgICB9XG5cbiAgICAvLyDkv53lrZjliY3jgavjgYTjgY/jgaTjgYvjga7jgqTjg5njg7Pjg4jjga5idXNpbmVzc0NvZGXjgahkZXBhcnRtZW50Q29kZeOCkuODreOCsOOBq+WHuuWKm1xuICAgIGlmIChldmVudHMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDkv53lrZjjgZnjgovjgqTjg5njg7Pjg4jjga7jgrXjg7Pjg5fjg6s6XCIsXG4gICAgICAgIGV2ZW50cy5zbGljZSgwLCAzKS5tYXAoKGUpID0+ICh7XG4gICAgICAgICAga2V5SUQ6IGUua2V5SUQsXG4gICAgICAgICAgYWN0aXZpdHlDb2RlOiBlLmFjdGl2aXR5Q29kZSxcbiAgICAgICAgICBidXNpbmVzc0NvZGU6IGUuYnVzaW5lc3NDb2RlLCAvLyBidXNpbmVzc0NvZGXjgpLjg63jgrDjgavov73liqBcbiAgICAgICAgICBkZXBhcnRtZW50Q29kZTogZS5kZXBhcnRtZW50Q29kZSwgLy8gZGVwYXJ0bWVudENvZGXjgpLjg63jgrDjgavov73liqBcbiAgICAgICAgICBjbGFzc2lmaWNhdGlvbjU6IGUuY2xhc3NpZmljYXRpb241LFxuICAgICAgICAgIGNsYXNzaWZpY2F0aW9uNjogZS5jbGFzc2lmaWNhdGlvbjYsXG4gICAgICAgICAgY2xhc3NpZmljYXRpb243OiBlLmNsYXNzaWZpY2F0aW9uNyxcbiAgICAgICAgfSkpLFxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDpgLHjg4fjg7zjgr/kv53lrZhBUEk6ICR7ZXZlbnRzLmxlbmd0aH3ku7bjga7jgqTjg5njg7Pjg4jjgpLkv53lrZjjgZfjgb7jgZlgKVxuXG4gICAgY29uc3QgdXBkYXRlZEV2ZW50cyA9IGF3YWl0IHdpdGhUcmFuc2FjdGlvbihhc3luYyAoZGIpID0+IHtcbiAgICAgIGNvbnN0IHsgc3RhcnREYXRlLCBlbmREYXRlIH0gPSBnZXRXZWVrRGF0ZXMoeWVhck51bSwgd2Vla051bSlcbiAgICAgIGNvbnN0IHN0YXJ0RGF0ZVN0ciA9IGZvcm1hdERhdGUoc3RhcnREYXRlKSArIFwiIDAwOjAwOjAwXCJcbiAgICAgIGNvbnN0IGVuZERhdGVTdHIgPSBmb3JtYXREYXRlKG5ldyBEYXRlKGVuZERhdGUuZ2V0VGltZSgpICsgODY0MDAwMDApKSArIFwiIDAwOjAwOjAwXCJcblxuICAgICAgLy8g54++5Zyo44Gu44Om44O844K244O8SUTjgpLlj5blvpdcbiAgICAgIGNvbnN0IGN1cnJlbnRVc2VySWQgPSBhd2FpdCBnZXRDdXJyZW50VXNlcklkKClcbiAgICAgIGNvbnNvbGUubG9nKFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDnj77lnKjjga7jg6bjg7zjgrbjg7xJRDpcIiwgY3VycmVudFVzZXJJZClcblxuICAgICAgLy8g54++5Zyo44Gu44Om44O844K244O844Gu6YCx44OH44O844K/44Gu44G/44KS5Y+W5b6XXG4gICAgICBjb25zdCBleGlzdGluZ0V2ZW50cyA9IGF3YWl0IGRiLmFsbChcbiAgICAgICAgXCJTRUxFQ1Qga2V5SUQgRlJPTSBtYWluX1ppc3Nla2kgV0hFUkUgc3RhcnREYXRlVGltZSA+PSA/IEFORCBzdGFydERhdGVUaW1lIDwgPyBBTkQgZW1wbG95ZWVOdW1iZXIgPSA/XCIsXG4gICAgICAgIFtzdGFydERhdGVTdHIsIGVuZERhdGVTdHIsIGN1cnJlbnRVc2VySWRdLFxuICAgICAgKVxuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgXCLpgLHjg4fjg7zjgr/kv53lrZhBUEk6IOOCr+ODqeOCpOOCouODs+ODiOOBi+OCieWPl+S/oeOBl+OBn+OCpOODmeODs+ODiDpcIixcbiAgICAgICAgZXZlbnRzLm1hcCgoZSkgPT4gKHtcbiAgICAgICAgICBpZDogZS5pZCxcbiAgICAgICAgICBrZXlJRDogZS5rZXlJRCxcbiAgICAgICAgICBlbXBsb3llZU51bWJlcjogZS5lbXBsb3llZU51bWJlcixcbiAgICAgICAgfSkpLFxuICAgICAgKVxuXG4gICAgICBjb25zb2xlLmxvZyhcIumAseODh+ODvOOCv+S/neWtmEFQSTog44OH44O844K/44OZ44O844K544Gu5pei5a2Y44Kk44OZ44Oz44OIOlwiLCBleGlzdGluZ0V2ZW50cylcblxuICAgICAgLy8g44Kk44OZ44Oz44OI44Gu5Z6L44KS5a6a576pXG4gICAgICB0eXBlIEV2ZW50VHlwZSA9IHtcbiAgICAgICAga2V5SUQ6IHN0cmluZ1xuICAgICAgICBba2V5OiBzdHJpbmddOiBhbnlcbiAgICAgIH1cblxuICAgICAgLy8g5Z6L44KS6YGp55SoIC0ga2V5SUTjgpLlhKrlhYjnmoTjgavkvb/nlKhcbiAgICAgIGNvbnN0IGV2ZW50SWRzID0gZXZlbnRzLmZpbHRlcigoZTogRXZlbnRUeXBlKSA9PiBlLmtleUlEIHx8IGUuaWQpLm1hcCgoZTogRXZlbnRUeXBlKSA9PiBlLmtleUlEIHx8IGUuaWQpXG5cbiAgICAgIGNvbnNvbGUubG9nKFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDjgq/jg6njgqTjgqLjg7Pjg4jlgbTjga7jgqTjg5njg7Pjg4hJRDpcIiwgZXZlbnRJZHMpXG5cbiAgICAgIC8vIOePvuWcqOOBruODpuODvOOCtuODvOOBruOCpOODmeODs+ODiOOBruOBv+OCkuWJiumZpOWvvuixoeOBq+OBmeOCi1xuICAgICAgY29uc3QgaWRzVG9EZWxldGUgPSBleGlzdGluZ0V2ZW50c1xuICAgICAgICAubWFwKChlOiB7IGtleUlEOiBzdHJpbmcgfSkgPT4gZS5rZXlJRClcbiAgICAgICAgLmZpbHRlcigoaWQ6IHN0cmluZykgPT4gIWV2ZW50SWRzLmluY2x1ZGVzKGlkKSlcblxuICAgICAgY29uc29sZS5sb2coXCLpgLHjg4fjg7zjgr/kv53lrZhBUEk6IOWJiumZpOWvvuixoeOBruOCpOODmeODs+ODiElEOlwiLCBpZHNUb0RlbGV0ZSlcbiAgICAgIGNvbnNvbGUubG9nKFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDkv53lrZjlr77osaHjga7jgqTjg5njg7Pjg4hJRDpcIiwgZXZlbnRJZHMpXG5cbiAgICAgIGlmIChpZHNUb0RlbGV0ZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHBsYWNlaG9sZGVycyA9IGlkc1RvRGVsZXRlLm1hcCgoKSA9PiBcIj9cIikuam9pbihcIixcIilcbiAgICAgICAgYXdhaXQgZGIucnVuKGBERUxFVEUgRlJPTSBtYWluX1ppc3Nla2kgV0hFUkUga2V5SUQgSU4gKCR7cGxhY2Vob2xkZXJzfSlgLCBpZHNUb0RlbGV0ZSlcbiAgICAgICAgY29uc29sZS5sb2coYOmAseODh+ODvOOCv+S/neWtmEFQSTogJHtpZHNUb0RlbGV0ZS5sZW5ndGh95Lu244Gu44Kk44OZ44Oz44OI44KS5YmK6Zmk44GX44G+44GX44GfYClcbiAgICAgIH1cblxuICAgICAgY29uc3QgdXBkYXRlZEV2ZW50SWRzID0gW11cblxuICAgICAgZm9yIChjb25zdCBldmVudCBvZiBldmVudHMpIHtcbiAgICAgICAgLy8ga2V5SUTjgpLlhKrlhYjnmoTjgavkvb/nlKhcbiAgICAgICAgY29uc3QgZXZlbnRLZXlJRCA9IGV2ZW50LmtleUlEIHx8IGV2ZW50LmlkXG4gICAgICAgIGNvbnNvbGUubG9nKFwi6YCx44OH44O844K/5L+d5a2YQVBJOiDlh6bnkIbkuK3jga7jgqTjg5njg7Pjg4g6XCIsIGV2ZW50S2V5SUQsIFwiZW1wbG95ZWVOdW1iZXI6XCIsIGV2ZW50LmVtcGxveWVlTnVtYmVyKVxuXG4gICAgICAgIC8vIElE44GM5pei44Gr5a2Y5Zyo44GZ44KL44GL44OB44Kn44OD44KvXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgZGIuZ2V0KFwiU0VMRUNUIGtleUlEIEZST00gbWFpbl9aaXNzZWtpIFdIRVJFIGtleUlEID0gP1wiLCBbZXZlbnRLZXlJRF0pXG5cbiAgICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLpgLHjg4fjg7zjgr/kv53lrZhBUEk6IFVQREFUReWvvuixoTpcIiwgZXZlbnRLZXlJRClcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIumAseODh+ODvOOCv+S/neWtmEFQSTog5pu05paw44OH44O844K/OlwiLCB7XG4gICAgICAgICAgICBjbGFzc2lmaWNhdGlvbjU6IGV2ZW50LmNsYXNzaWZpY2F0aW9uNSxcbiAgICAgICAgICAgIGFjdGl2aXR5Q29kZTogZXZlbnQuYWN0aXZpdHlDb2RlLFxuICAgICAgICAgIH0pXG5cbiAgICAgICAgICBjb25zdCBjb2x1bW5zID0gT2JqZWN0LmtleXMoZXZlbnQpLmZpbHRlcigoaykgPT4gayAhPT0gXCJrZXlJRFwiICYmIGsgIT09IFwiaWRcIilcbiAgICAgICAgICBjb25zdCBzZXRDbGF1c2UgPSBjb2x1bW5zLm1hcCgoYykgPT4gYCR7Y30gPSA/YCkuam9pbihcIixcIilcbiAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbLi4uY29sdW1ucy5tYXAoKGMpID0+IGV2ZW50W2NdKSwgZXZlbnRLZXlJRF1cbiAgICAgICAgICBhd2FpdCBkYi5ydW4oYFVQREFURSBtYWluX1ppc3Nla2kgU0VUICR7c2V0Q2xhdXNlfSBXSEVSRSBrZXlJRCA9ID9gLCB2YWx1ZXMpXG4gICAgICAgICAgdXBkYXRlZEV2ZW50SWRzLnB1c2goeyBvbGRJZDogZXZlbnQub2xkSWQsIG5ld0lkOiBldmVudEtleUlEIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coXCLpgLHjg4fjg7zjgr/kv53lrZhBUEk6IElOU0VSVOWvvuixoTpcIiwgZXZlbnRLZXlJRClcbiAgICAgICAgICAvLyBpZOOBqGtleUlE44Gu5Lih5pa544KS6Zmk5aSW44GX44CBa2V5SUTjga7jgb/jgpLkvb/nlKhcbiAgICAgICAgICBjb25zdCBmaWx0ZXJlZEV2ZW50ID0geyAuLi5ldmVudCB9XG4gICAgICAgICAgaWYgKGZpbHRlcmVkRXZlbnQuaWQpIGRlbGV0ZSBmaWx0ZXJlZEV2ZW50LmlkXG5cbiAgICAgICAgICBjb25zdCBjb2x1bW5zID0gT2JqZWN0LmtleXMoZmlsdGVyZWRFdmVudClcbiAgICAgICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBjb2x1bW5zLm1hcCgoKSA9PiBcIj9cIikuam9pbihcIixcIilcbiAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBjb2x1bW5zLm1hcCgoYykgPT4gZmlsdGVyZWRFdmVudFtjXSlcbiAgICAgICAgICBhd2FpdCBkYi5ydW4oYElOU0VSVCBJTlRPIG1haW5fWmlzc2VraSAoJHtjb2x1bW5zLmpvaW4oXCIsXCIpfSkgVkFMVUVTICgke3BsYWNlaG9sZGVyc30pYCwgdmFsdWVzKVxuXG4gICAgICAgICAgaWYgKGV2ZW50Lm9sZElkKSB7XG4gICAgICAgICAgICB1cGRhdGVkRXZlbnRJZHMucHVzaCh7IG9sZElkOiBldmVudC5vbGRJZCwgbmV3SWQ6IGV2ZW50S2V5SUQgfSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc29sZS5sb2coYOmAseODh+ODvOOCv+S/neWtmEFQSTog5Yem55CG5a6M5LqGIC0gJHt1cGRhdGVkRXZlbnRJZHMubGVuZ3RofeS7tuOBruOCpOODmeODs+ODiElE44KS5pu05paw44GX44G+44GX44GfYClcbiAgICAgIHJldHVybiB1cGRhdGVkRXZlbnRJZHNcbiAgICB9KVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIumAseODh+ODvOOCv+OBjOato+W4uOOBq+S/neWtmOOBleOCjOOBvuOBl+OBn1wiLFxuICAgICAgdXBkYXRlZEV2ZW50czogdXBkYXRlZEV2ZW50cyxcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLpgLHjg4fjg7zjgr/kv53lrZhBUEk6IOOCqOODqeODvOeZuueUn1wiLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiBcIumAseODh+ODvOOCv+OBruS/neWtmOS4reOBq+OCqOODqeODvOOBjOeZuueUn+OBl+OBvuOBl+OBn1wiLFxuICAgICAgICBlcnJvcjogU3RyaW5nKGVycm9yKSxcbiAgICAgIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH0sXG4gICAgKVxuICB9XG59XG5cbi8vIOijnOWKqemWouaVsFxuZnVuY3Rpb24gZ2V0V2Vla0RhdGVzKHllYXI6IG51bWJlciwgd2VlazogbnVtYmVyKSB7XG4gIGNvbnN0IGZpcnN0RGF5T2ZZZWFyID0gbmV3IERhdGUoeWVhciwgMCwgMSlcbiAgY29uc3QgZGF5c09mZnNldCA9IGZpcnN0RGF5T2ZZZWFyLmdldERheSgpID09PSAwID8gNiA6IGZpcnN0RGF5T2ZZZWFyLmdldERheSgpIC0gMVxuICBjb25zdCBmaXJzdFdlZWtEYXkgPSBuZXcgRGF0ZSh5ZWFyLCAwLCAxICsgKHdlZWsgLSAxKSAqIDcgLSBkYXlzT2Zmc2V0KVxuICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShmaXJzdFdlZWtEYXkpXG4gIHN0YXJ0RGF0ZS5zZXREYXRlKGZpcnN0V2Vla0RheS5nZXREYXRlKCkgLSBmaXJzdFdlZWtEYXkuZ2V0RGF5KCkpXG4gIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpXG4gIGVuZERhdGUuc2V0RGF0ZShzdGFydERhdGUuZ2V0RGF0ZSgpICsgNilcbiAgcmV0dXJuIHsgc3RhcnREYXRlLCBlbmREYXRlIH1cbn1cblxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlOiBEYXRlKSB7XG4gIHJldHVybiBgJHtkYXRlLmdldEZ1bGxZZWFyKCl9LSR7KGRhdGUuZ2V0TW9udGgoKSArIDEpXG4gICAgLnRvU3RyaW5nKClcbiAgICAucGFkU3RhcnQoMiwgXCIwXCIpfS0ke2RhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfWBcbn1cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRBY2hpZXZlbWVudHNCeVdlZWsiLCJ3aXRoVHJhbnNhY3Rpb24iLCJnZXRDdXJyZW50VXNlcklkIiwicnVudGltZSIsIkdFVCIsInJlcXVlc3QiLCJwYXJhbXMiLCJjb25zb2xlIiwibG9nIiwieWVhciIsIndlZWsiLCJ5ZWFyTnVtIiwiTnVtYmVyIiwicGFyc2VJbnQiLCJ3ZWVrTnVtIiwiaXNOYU4iLCJlcnJvciIsImpzb24iLCJzdWNjZXNzIiwibWVzc2FnZSIsInN0YXR1cyIsImFjaGlldmVtZW50cyIsImxlbmd0aCIsImtleUlEIiwiYnVzaW5lc3NDb2RlIiwiZGVwYXJ0bWVudENvZGUiLCJjbGFzc2lmaWNhdGlvbjUiLCJjbGFzc2lmaWNhdGlvbjYiLCJjbGFzc2lmaWNhdGlvbjciLCJkYXRhIiwiU3RyaW5nIiwiUE9TVCIsImJvZHkiLCJldmVudHMiLCJBcnJheSIsImlzQXJyYXkiLCJzbGljZSIsIm1hcCIsImUiLCJhY3Rpdml0eUNvZGUiLCJ1cGRhdGVkRXZlbnRzIiwiZGIiLCJzdGFydERhdGUiLCJlbmREYXRlIiwiZ2V0V2Vla0RhdGVzIiwic3RhcnREYXRlU3RyIiwiZm9ybWF0RGF0ZSIsImVuZERhdGVTdHIiLCJEYXRlIiwiZ2V0VGltZSIsImN1cnJlbnRVc2VySWQiLCJleGlzdGluZ0V2ZW50cyIsImFsbCIsImlkIiwiZW1wbG95ZWVOdW1iZXIiLCJldmVudElkcyIsImZpbHRlciIsImlkc1RvRGVsZXRlIiwiaW5jbHVkZXMiLCJwbGFjZWhvbGRlcnMiLCJqb2luIiwicnVuIiwidXBkYXRlZEV2ZW50SWRzIiwiZXZlbnQiLCJldmVudEtleUlEIiwiZXhpc3RpbmciLCJnZXQiLCJjb2x1bW5zIiwiT2JqZWN0Iiwia2V5cyIsImsiLCJzZXRDbGF1c2UiLCJjIiwidmFsdWVzIiwicHVzaCIsIm9sZElkIiwibmV3SWQiLCJmaWx0ZXJlZEV2ZW50IiwiZmlyc3REYXlPZlllYXIiLCJkYXlzT2Zmc2V0IiwiZ2V0RGF5IiwiZmlyc3RXZWVrRGF5Iiwic2V0RGF0ZSIsImdldERhdGUiLCJkYXRlIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsInRvU3RyaW5nIiwicGFkU3RhcnQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/achievements/week/[year]/[week]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db_utils.ts":
/*!*************************!*\
  !*** ./lib/db_utils.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addAchievement: () => (/* binding */ addAchievement),\n/* harmony export */   addActivityType: () => (/* binding */ addActivityType),\n/* harmony export */   addProjectDetails: () => (/* binding */ addProjectDetails),\n/* harmony export */   addProjectPurchaseItem: () => (/* binding */ addProjectPurchaseItem),\n/* harmony export */   addUserProject: () => (/* binding */ addUserProject),\n/* harmony export */   deleteAchievement: () => (/* binding */ deleteAchievement),\n/* harmony export */   deleteActivityType: () => (/* binding */ deleteActivityType),\n/* harmony export */   getAchievementsByMonth: () => (/* binding */ getAchievementsByMonth),\n/* harmony export */   getAchievementsByWeek: () => (/* binding */ getAchievementsByWeek),\n/* harmony export */   getActivityTypeColumns: () => (/* binding */ getActivityTypeColumns),\n/* harmony export */   getActivityTypes: () => (/* binding */ getActivityTypes),\n/* harmony export */   getCurrentUser: () => (/* binding */ getCurrentUser),\n/* harmony export */   getCurrentUserId: () => (/* binding */ getCurrentUserId),\n/* harmony export */   getDbConnection: () => (/* binding */ getDbConnection),\n/* harmony export */   getEmployees: () => (/* binding */ getEmployees),\n/* harmony export */   getProjectEquipmentNumbers: () => (/* binding */ getProjectEquipmentNumbers),\n/* harmony export */   getProjectPurchaseItems: () => (/* binding */ getProjectPurchaseItems),\n/* harmony export */   getProjectSummaryByMonth: () => (/* binding */ getProjectSummaryByMonth),\n/* harmony export */   getProjects: () => (/* binding */ getProjects),\n/* harmony export */   getTableColumns: () => (/* binding */ getTableColumns),\n/* harmony export */   getUser: () => (/* binding */ getUser),\n/* harmony export */   getUserProjects: () => (/* binding */ getUserProjects),\n/* harmony export */   setCurrentUserId: () => (/* binding */ setCurrentUserId),\n/* harmony export */   updateAchievement: () => (/* binding */ updateAchievement),\n/* harmony export */   updateActivityType: () => (/* binding */ updateActivityType),\n/* harmony export */   withTransaction: () => (/* binding */ withTransaction)\n/* harmony export */ });\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sqlite3 */ \"sqlite3\");\n/* harmony import */ var sqlite3__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sqlite3__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sqlite__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sqlite */ \"(rsc)/./node_modules/sqlite/build/index.mjs\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n// データベースファイルのパス\nconst DB_PATH = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data\", \"achievements.db\");\n/**\n * データベース接続を取得する関数\n * @param dbName オプション：データベース名（デフォルトはachievements.db）\n * @returns SQLiteデータベース接続\n */ async function getDbConnection(dbName) {\n    // データディレクトリが存在しない場合は作成\n    const dataDir = path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data\");\n    if (!fs__WEBPACK_IMPORTED_MODULE_3___default().existsSync(dataDir)) {\n        fs__WEBPACK_IMPORTED_MODULE_3___default().mkdirSync(dataDir, {\n            recursive: true\n        });\n    }\n    // データベースファイルのパスを設定\n    const dbPath = dbName ? path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data\", `${dbName}.db`) : path__WEBPACK_IMPORTED_MODULE_2___default().join(process.cwd(), \"data\", \"achievements.db\");\n    // データベースに接続\n    const db = await (0,sqlite__WEBPACK_IMPORTED_MODULE_1__.open)({\n        filename: dbPath,\n        driver: (sqlite3__WEBPACK_IMPORTED_MODULE_0___default().Database)\n    });\n    // 外部キー制約を有効化\n    await db.run(\"PRAGMA foreign_keys = ON\");\n    return db;\n}\n/**\n * トランザクションを使用してデータベース操作を行う関数\n * @param callback トランザクション内で実行するコールバック関数\n * @returns コールバック関数の戻り値\n */ async function withTransaction(callback) {\n    const db = await getDbConnection();\n    try {\n        // トランザクション開始\n        await db.run(\"BEGIN TRANSACTION\");\n        // コールバック関数を実行\n        const result = await callback(db);\n        // トランザクションをコミット\n        await db.run(\"COMMIT\");\n        return result;\n    } catch (error) {\n        // エラーが発生した場合はロールバック\n        await db.run(\"ROLLBACK\");\n        throw error;\n    } finally{\n        // データベース接続を閉じる\n        await db.close();\n    }\n}\n/**\n * 従業員データを取得する関数\n * @returns 従業員データの配列\n */ async function getEmployees() {\n    const db = await getDbConnection();\n    try {\n        return await db.all(\"SELECT * FROM employees ORDER BY employeeNumber\");\n    } finally{\n        await db.close();\n    }\n}\n/**\n * プロジェクトデータを取得する関数\n * @returns プロジェクトデータの配列\n */ async function getProjects() {\n    const db = await getDbConnection();\n    try {\n        return await db.all(\"SELECT * FROM projects ORDER BY projectNumber\");\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 活動タイプデータを取得する関数\n * @param dbName オプション：データベース名\n * @returns 活動タイプデータの配列\n */ async function getActivityTypes(dbName) {\n    const db = await getDbConnection(dbName);\n    try {\n        return await db.all(\"SELECT * FROM m_activity_types ORDER BY displayOrder, typeCode\");\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 現在のユーザーIDを取得する関数\n * @returns 現在のユーザーID（文字列）またはnull\n */ async function getCurrentUserId() {\n    const db = await getDbConnection();\n    try {\n        const setting = await db.get(\"SELECT value FROM app_settings WHERE key = 'Now_userID'\");\n        return setting ? setting.value : null;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 現在のユーザー情報を取得する関数\n * @returns ユーザー情報\n */ async function getCurrentUser() {\n    const userId = await getCurrentUserId();\n    const db = await getDbConnection();\n    try {\n        const user = await db.get(\"SELECT * FROM employees WHERE employeeNumber = ?\", [\n            userId\n        ]);\n        return user || null;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 現在のユーザーIDを設定する関数\n * @param userId 設定するユーザーID\n * @returns 設定が成功したかどうか\n */ async function setCurrentUserId(userId) {\n    const db = await getDbConnection();\n    try {\n        await db.run(\"INSERT OR REPLACE INTO app_settings (key, value, description) VALUES (?, ?, ?)\", [\n            \"Now_userID\",\n            userId,\n            \"現在ログイン中のユーザーID\"\n        ]);\n        return true;\n    } catch (error) {\n        return false;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 特定の年月の実績データを取得する関数\n * @param year 年\n * @param month 月\n * @returns 実績データの配列\n */ async function getAchievementsByMonth(year, month) {\n    const db = await getDbConnection();\n    try {\n        const startDate = `${year}-${month.toString().padStart(2, \"0\")}-01 00:00:00`;\n        const nextMonth = month === 12 ? 1 : month + 1;\n        const nextYear = month === 12 ? year + 1 : year;\n        const endDate = `${nextYear}-${nextMonth.toString().padStart(2, \"0\")}-01 00:00:00`;\n        return await db.all(\"SELECT * FROM main_Zisseki WHERE startDateTime >= ? AND startDateTime < ? ORDER BY startDateTime\", [\n            startDate,\n            endDate\n        ]);\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 特定の年と週の実績データを取得する関数\n * @param year 年\n * @param week 週番号\n * @returns 実績データの配列\n */ async function getAchievementsByWeek(year, week) {\n    const db = await getDbConnection();\n    try {\n        const { startDate, endDate } = getWeekDates(year, week);\n        const startDateStr = formatDate(startDate) + \" 00:00:00\";\n        const endDateStr = formatDate(new Date(endDate.getTime() + 86400000)) + \" 00:00:00\";\n        // 現在のユーザーIDを取得\n        const currentUserId = await getCurrentUserId();\n        // 取得するデータのフィールドを明示的に指定\n        const results = await db.all(`SELECT \n        keyID, employeeNumber, startDateTime, endDateTime, subject, content, \n        type, organizer, projectNumber, position, facility, status, \n        businessCode, departmentCode, weekCode, \n        classification1, classification2, classification3, classification4, \n        classification5, classification6, classification7, classification8, classification9\n      FROM main_Zisseki \n      WHERE employeeNumber = ? AND startDateTime >= ? AND startDateTime < ? \n      ORDER BY startDateTime`, [\n            currentUserId,\n            startDateStr,\n            endDateStr\n        ]);\n        return results;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 実績データを追加する関数\n * @param achievement 実績データオブジェクト\n * @returns 挿入されたデータのID\n */ async function addAchievement(achievement) {\n    const db = await getDbConnection();\n    try {\n        const columns = Object.keys(achievement).join(\", \");\n        const placeholders = Object.keys(achievement).map(()=>\"?\").join(\", \");\n        const values = Object.values(achievement);\n        const result = await db.run(`INSERT INTO main_Zisseki (${columns}) VALUES (${placeholders})`, values);\n        return achievement.keyID;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 実績データを更新する関数\n * @param keyID 更新するデータのID\n * @param achievement 更新する実績データオブジェクト\n * @returns 更新が成功したかどうか\n */ async function updateAchievement(keyID, achievement) {\n    const db = await getDbConnection();\n    try {\n        const setClause = Object.keys(achievement).map((key)=>`${key} = ?`).join(\", \");\n        const values = [\n            ...Object.values(achievement),\n            keyID\n        ];\n        const result = await db.run(`UPDATE main_Zisseki SET ${setClause} WHERE keyID = ?`, values);\n        return result.changes > 0;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 実績データを削除する関数\n * @param keyID 削除するデータのID\n * @returns 削除が成功したかどうか\n */ async function deleteAchievement(keyID) {\n    const db = await getDbConnection();\n    try {\n        const result = await db.run(\"DELETE FROM main_Zisseki WHERE keyID = ?\", [\n            keyID\n        ]);\n        return result.changes > 0;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * ユーザーのプロジェクトリストを取得する関数\n * @param userID ユーザーID\n * @param projectCode 特定のプロジェクトコード（オプション）\n * @returns プロジェクトの配列\n */ async function getUserProjects(userID, projectCode) {\n    const db = await getDbConnection();\n    try {\n        // project_member_historiesテーブルからデータを取得\n        let query = `\n      SELECT \n        pmh.*,\n        p.projectNumber,\n        p.name as projectName,\n        p.clientName,\n        p.classification,\n        p.status,\n        p.isProject,\n        p.projectNumber as projectCode,\n        pmh.role,\n        pmh.start_date as startDate\n      FROM project_member_histories pmh\n      INNER JOIN projects p ON pmh.project_id = p.projectNumber\n      WHERE pmh.user_id = ?\n      AND (pmh.end_date IS NULL OR pmh.end_date > date('now'))\n    `;\n        const params = [\n            userID\n        ];\n        // プロジェクトコードが指定されている場合は条件を追加\n        if (projectCode) {\n            query += \" AND pmh.project_id = ?\";\n            params.push(projectCode);\n        }\n        query += \" ORDER BY p.projectNumber ASC\";\n        const results = await db.all(query, params);\n        // 結果が空の場合のみログを出力\n        if (results.length === 0) {\n            console.log(\"プロジェクトが見つかりませんでした。\");\n            console.log(\"SQL:\", query);\n            console.log(\"パラメータ:\", params);\n        }\n        return results;\n    } catch (error) {\n        console.error(\"プロジェクト取得中にエラーが発生しました:\", error);\n        throw error;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * プロジェクトの設備番号リストを取得する関数\n * @param projectCode プロジェクトコード\n * @returns 設備番号の配列\n */ async function getProjectEquipmentNumbers(projectCode) {\n    const db = await getDbConnection();\n    try {\n        // 直接projectsテーブルから取得\n        const result = await db.get(\"SELECT equipmentNumbers FROM projects WHERE projectNumber = ?\", [\n            projectCode\n        ]);\n        if (result && result.equipmentNumbers) {\n            return result.equipmentNumbers.split(\",\").map((item)=>item.trim());\n        }\n        return [];\n    } finally{\n        await db.close();\n    }\n}\n/**\n * プロジェクトの購入品リストを取得する関数\n * @param projectId プロジェクトID\n * @param equipmentNumber 設備番号\n * @returns 購入品の配列\n */ async function getProjectPurchaseItems(projectId, equipmentNumber) {\n    const db = await getDbConnection();\n    try {\n        const result = await db.all(\"SELECT * FROM project_purchase_items WHERE project_id = ? AND equipmentNumber = ? ORDER BY sequenceNumber\", [\n            projectId,\n            equipmentNumber\n        ]);\n        return result;\n    } catch (error) {\n        console.error(\"プロジェクト購入品の取得中にエラーが発生しました:\", error);\n        throw error;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * ユーザープロジェクト関連を追加する関数\n * @param userID ユーザーID\n * @param projectCode プロジェクトコード\n * @param role 役割\n * @returns 挿入されたデータのID\n */ async function addUserProject(userID, projectCode, role) {\n    const db = await getDbConnection();\n    try {\n        const today = new Date().toISOString().split(\"T\")[0];\n        // 既存のメンバーシップをチェック\n        const existingMember = await db.get(`SELECT * FROM project_member_histories \n       WHERE user_id = ? AND project_id = ? \n       AND (end_date IS NULL OR end_date > date('now'))`, [\n            userID,\n            projectCode\n        ]);\n        if (existingMember) {\n            // 既存のメンバーシップがある場合は役割のみ更新\n            await db.run(`UPDATE project_member_histories \n         SET role = ? \n         WHERE user_id = ? AND project_id = ? AND end_date IS NULL`, [\n                role,\n                userID,\n                projectCode\n            ]);\n            return `${userID}_${projectCode}`;\n        }\n        // 新しいメンバーシップを追加\n        const result = await db.run(`INSERT INTO project_member_histories (user_id, project_id, start_date, role) \n       VALUES (?, ?, ?, ?)`, [\n            userID,\n            projectCode,\n            today,\n            role\n        ]);\n        return `${userID}_${projectCode}`;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * プロジェクト詳細を追加する関数\n * @param projectDetails プロジェクト詳細オブジェクト\n * @returns 挿入されたデータのID\n */ async function addProjectDetails(projectDetails) {\n    const db = await getDbConnection();\n    try {\n        // equipmentNumbersが配列の場合、カンマ区切りの文字列に変換\n        if (Array.isArray(projectDetails.equipmentNumbers)) {\n            projectDetails.equipmentNumbers = projectDetails.equipmentNumbers.join(\",\");\n        }\n        const columns = Object.keys(projectDetails).join(\", \");\n        const placeholders = Object.keys(projectDetails).map(()=>\"?\").join(\", \");\n        const values = Object.values(projectDetails);\n        // projectsテーブルに直接挿入\n        await db.run(`INSERT OR REPLACE INTO projects (${columns}) VALUES (${placeholders})`, values);\n        return projectDetails.projectNumber;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * プロジェクト購入品を追加する関数\n * @param purchaseItem 購入品オブジェクト\n * @returns 挿入されたデータの複合主キー\n */ async function addProjectPurchaseItem(purchaseItem) {\n    const db = await getDbConnection();\n    try {\n        // 次の連番を取得\n        if (!purchaseItem.sequenceNumber) {\n            const nextSeq = await getNextPurchaseItemSequence(db, purchaseItem.project_id, purchaseItem.equipmentNumber);\n            purchaseItem.sequenceNumber = nextSeq.toString().padStart(3, \"0\");\n        }\n        // keyIDの生成・利用は不要\n        const columns = Object.keys(purchaseItem).join(\", \");\n        const placeholders = Object.keys(purchaseItem).map(()=>\"?\").join(\", \");\n        const values = Object.values(purchaseItem);\n        await db.run(`INSERT OR REPLACE INTO project_purchase_items (${columns}) VALUES (${placeholders})`, values);\n        // 複合主キーを返す\n        return {\n            project_id: purchaseItem.project_id,\n            equipmentNumber: purchaseItem.equipmentNumber,\n            sequenceNumber: purchaseItem.sequenceNumber\n        };\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 次の購入品連番を取得する関数\n * @param db データベース接続\n * @param projectId プロジェクトID\n * @param equipmentNumber 設備番号\n * @returns 次の連番\n */ async function getNextPurchaseItemSequence(db, projectId, equipmentNumber) {\n    const result = await db.get(\"SELECT MAX(CAST(sequenceNumber AS INTEGER)) as maxSeq FROM project_purchase_items WHERE project_id = ? AND equipmentNumber = ?\", [\n        projectId,\n        equipmentNumber\n    ]);\n    if (result && result.maxSeq !== null) {\n        return result.maxSeq + 1;\n    }\n    return 1;\n}\n// 週の開始日と終了日を取得する関数\nfunction getWeekDates(year, week) {\n    const firstDayOfYear = new Date(year, 0, 1);\n    const daysOffset = firstDayOfYear.getDay() === 0 ? 6 : firstDayOfYear.getDay() - 1;\n    const firstWeekDay = new Date(year, 0, 1 + (week - 1) * 7 - daysOffset);\n    const startDate = new Date(firstWeekDay);\n    startDate.setDate(firstWeekDay.getDate() - firstWeekDay.getDay());\n    const endDate = new Date(startDate);\n    endDate.setDate(startDate.getDate() + 6);\n    return {\n        startDate,\n        endDate\n    };\n}\n// 日付をYYYY-MM-DD形式にフォーマットする関数\nfunction formatDate(date) {\n    return `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, \"0\")}-${date.getDate().toString().padStart(2, \"0\")}`;\n}\n/**\n * テーブルのカラム情報を取得する関数\n * @param tableName テーブル名\n * @returns カラム情報の配列\n */ async function getTableColumns(tableName) {\n    const db = await getDbConnection();\n    try {\n        return await db.all(`PRAGMA table_info(${tableName})`);\n    } finally{\n        await db.close();\n    }\n}\n/**\n * m_activity_typesテーブルのカラム情報を取得する関数\n * @param dbName オプション：データベース名\n * @param tableName オプション：テーブル名（デフォルトはm_activity_types）\n * @returns カラム情報の配列（名前と日本語名のマッピングを含む）\n */ async function getActivityTypeColumns(dbName, tableName = \"m_activity_types\") {\n    const db = await getDbConnection(dbName);\n    try {\n        const columns = await db.all(`PRAGMA table_info(${tableName})`);\n        // カラム名と日本語表示名のマッピング\n        const columnNameMap = {\n            typeCode: \"コード\",\n            typeName: \"名称\",\n            description: \"説明\",\n            category: \"大分類\",\n            subCategory: \"中分類\",\n            displayOrder: \"表示順\",\n            color: \"色\",\n            isActive: \"状態\"\n        };\n        // 表示しないシステム列やID列\n        const excludedColumns = [\n            \"id\",\n            \"created_at\",\n            \"updated_at\"\n        ];\n        return columns.filter((col)=>!excludedColumns.includes(col.name)).map((col)=>({\n                id: col.name,\n                name: columnNameMap[col.name] || col.name,\n                dataType: col.type,\n                visible: Object.keys(columnNameMap).includes(col.name) // デフォルトで表示する列\n            }));\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 活動タイプを追加する関数\n * @param activityType 追加する活動タイプデータオブジェクト\n * @param dbName オプション：データベース名\n * @returns 追加した活動タイプデータ\n */ async function addActivityType(activityType, dbName) {\n    const db = await getDbConnection(dbName);\n    try {\n        const columns = Object.keys(activityType).join(\", \");\n        const placeholders = Object.keys(activityType).map(()=>\"?\").join(\", \");\n        const values = Object.values(activityType);\n        await db.run(`INSERT INTO m_activity_types (${columns}) VALUES (${placeholders})`, values);\n        // 追加したデータを返す\n        return activityType;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 活動タイプを更新する関数\n * @param typeCode 更新する活動タイプのコード\n * @param activityType 更新する活動タイプデータオブジェクト\n * @param dbName オプション：データベース名\n * @returns 更新が成功したかどうか\n */ async function updateActivityType(typeCode, activityType, dbName) {\n    const db = await getDbConnection(dbName);\n    try {\n        // typeCodeは更新対象の特定に使用するため、更新データから除外\n        const updateData = {\n            ...activityType\n        };\n        delete updateData.typeCode;\n        const setClause = Object.keys(updateData).map((key)=>`${key} = ?`).join(\", \");\n        const values = [\n            ...Object.values(updateData),\n            typeCode\n        ];\n        const result = await db.run(`UPDATE m_activity_types SET ${setClause} WHERE typeCode = ?`, values);\n        return result.changes > 0;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 活動タイプを削除する関数\n * @param typeCode 削除する活動タイプのコード\n * @param dbName オプション：データベース名\n * @returns 削除が成功したかどうか\n */ async function deleteActivityType(typeCode, dbName) {\n    const db = await getDbConnection(dbName);\n    try {\n        const result = await db.run(\"DELETE FROM m_activity_types WHERE typeCode = ?\", [\n            typeCode\n        ]);\n        return result.changes > 0;\n    } finally{\n        await db.close();\n    }\n}\n/**\n * 特定の年月のプロジェクトコード別業務集計データを取得する関数\n * @param year 年\n * @param month 月\n * @returns プロジェクトコード別の業務集計データ\n */ async function getProjectSummaryByMonth(year, month) {\n    const db = await getDbConnection();\n    try {\n        const startDate = `${year}-${month.toString().padStart(2, \"0\")}-01 00:00:00`;\n        const nextMonth = month === 12 ? 1 : month + 1;\n        const nextYear = month === 12 ? year + 1 : year;\n        const endDate = `${nextYear}-${nextMonth.toString().padStart(2, \"0\")}-01 00:00:00`;\n        // プロジェクトコード別の業務時間集計\n        const projectSummary = await db.all(`\n      SELECT \n        z.projectNumber, \n        p.name as projectName,\n        COUNT(z.keyID) as taskCount,\n        SUM((julianday(z.endDateTime) - julianday(z.startDateTime)) * 24) as totalHours,\n        z.type\n      FROM \n        main_Zisseki z\n      LEFT JOIN\n        projects p ON z.projectNumber = p.projectNumber\n      WHERE \n        z.startDateTime >= ? AND \n        z.startDateTime < ?\n      GROUP BY \n        z.projectNumber, z.type\n      ORDER BY \n        totalHours DESC\n      `, [\n            startDate,\n            endDate\n        ]);\n        // 業務タイプ別の集計\n        const typeSummary = await db.all(`\n      SELECT \n        z.type, \n        COUNT(z.keyID) as taskCount,\n        SUM((julianday(z.endDateTime) - julianday(z.startDateTime)) * 24) as totalHours\n      FROM \n        main_Zisseki z\n      WHERE \n        z.startDateTime >= ? AND \n        z.startDateTime < ?\n      GROUP BY \n        z.type\n      ORDER BY \n        totalHours DESC\n      `, [\n            startDate,\n            endDate\n        ]);\n        return {\n            projectSummary,\n            typeSummary\n        };\n    } finally{\n        await db.close();\n    }\n}\nasync function getUser(userId) {\n    const db = await getDbConnection();\n    try {\n        const user = await db.get(`\n      SELECT \n        user_id,\n        name_japanese as name,\n        syokui as position,\n        bumon as department,\n        sitsu as section,\n        ka as team,\n        mail as email,\n        TEL_naisen as telNaisen,\n        TEL as telGaisen,\n        company,\n        name_english,\n        name_yomi,\n        in_year,\n        Kengen as authority\n      FROM all_user\n      WHERE user_id = ?\n    `, [\n            userId\n        ]);\n        return user;\n    } catch (error) {\n        console.error(\"ユーザー情報の取得中にエラーが発生しました:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJQSxRQUFRO1FBQzdDLE1BQU1LLFdBQVdMLFVBQVUsS0FBS0QsT0FBTyxJQUFJQTtRQUMzQyxNQUFNTyxVQUFVLENBQUMsRUFBRUQsU0FBUyxDQUFDLEVBQUVELFVBQVVGLFFBQVEsR0FBR0MsUUFBUSxDQUFDLEdBQUcsS0FBSyxZQUFZLENBQUM7UUFFbEYsb0JBQW9CO1FBQ3BCLE1BQU1rRyxpQkFBaUIsTUFBTTdILEdBQUdXLEdBQUcsQ0FDakMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O01Ba0JELENBQUMsRUFDRDtZQUFDYztZQUFXSztTQUFRO1FBR3RCLFlBQVk7UUFDWixNQUFNZ0csY0FBYyxNQUFNOUgsR0FBR1csR0FBRyxDQUM5QixDQUFDOzs7Ozs7Ozs7Ozs7OztNQWNELENBQUMsRUFDRDtZQUFDYztZQUFXSztTQUFRO1FBR3RCLE9BQU87WUFDTCtGO1lBQ0FDO1FBQ0Y7SUFDRixTQUFVO1FBQ1IsTUFBTTlILEdBQUdTLEtBQUs7SUFDaEI7QUFDRjtBQUVPLGVBQWVzSCxRQUFRNUcsTUFBYztJQUMxQyxNQUFNbkIsS0FBSyxNQUFNUDtJQUNqQixJQUFJO1FBQ0YsTUFBTTJCLE9BQU8sTUFBTXBCLEdBQUdnQixHQUFHLENBQUMsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBa0IzQixDQUFDLEVBQUU7WUFBQ0c7U0FBTztRQUVYLE9BQU9DO0lBQ1QsRUFBRSxPQUFPWixPQUFPO1FBQ2RzRCxRQUFRdEQsS0FBSyxDQUFDLDBCQUEwQkE7UUFDeEMsTUFBTUE7SUFDUjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcG1lLXN5c3RlbS12MC4wMXByb2plY3QvLi9saWIvZGJfdXRpbHMudHM/NmUxNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc3FsaXRlMyBmcm9tIFwic3FsaXRlM1wiXG5pbXBvcnQgeyBvcGVuIH0gZnJvbSBcInNxbGl0ZVwiXG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiXG5pbXBvcnQgZnMgZnJvbSBcImZzXCJcblxuLy8g44OH44O844K/44OZ44O844K544OV44Kh44Kk44Or44Gu44OR44K5XG5jb25zdCBEQl9QQVRIID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiZGF0YVwiLCBcImFjaGlldmVtZW50cy5kYlwiKVxuXG4vKipcbiAqIOODh+ODvOOCv+ODmeODvOOCueaOpee2muOCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHBhcmFtIGRiTmFtZSDjgqrjg5fjgrfjg6fjg7PvvJrjg4fjg7zjgr/jg5njg7zjgrnlkI3vvIjjg4fjg5Xjgqnjg6vjg4jjga9hY2hpZXZlbWVudHMuZGLvvIlcbiAqIEByZXR1cm5zIFNRTGl0ZeODh+ODvOOCv+ODmeODvOOCueaOpee2mlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RGJDb25uZWN0aW9uKGRiTmFtZT86IHN0cmluZykge1xuICAvLyDjg4fjg7zjgr/jg4fjgqPjg6zjgq/jg4jjg6rjgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjga/kvZzmiJBcbiAgY29uc3QgZGF0YURpciA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImRhdGFcIilcbiAgaWYgKCFmcy5leGlzdHNTeW5jKGRhdGFEaXIpKSB7XG4gICAgZnMubWtkaXJTeW5jKGRhdGFEaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG4gIH1cblxuICAvLyDjg4fjg7zjgr/jg5njg7zjgrnjg5XjgqHjgqTjg6vjga7jg5HjgrnjgpLoqK3lrppcbiAgY29uc3QgZGJQYXRoID0gZGJOYW1lIFxuICAgID8gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIFwiZGF0YVwiLCBgJHtkYk5hbWV9LmRiYClcbiAgICA6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBcImRhdGFcIiwgXCJhY2hpZXZlbWVudHMuZGJcIilcblxuICAvLyDjg4fjg7zjgr/jg5njg7zjgrnjgavmjqXntppcbiAgY29uc3QgZGIgPSBhd2FpdCBvcGVuKHtcbiAgICBmaWxlbmFtZTogZGJQYXRoLFxuICAgIGRyaXZlcjogc3FsaXRlMy5EYXRhYmFzZSxcbiAgfSlcblxuICAvLyDlpJbpg6jjgq3jg7zliLbntITjgpLmnInlirnljJZcbiAgYXdhaXQgZGIucnVuKFwiUFJBR01BIGZvcmVpZ25fa2V5cyA9IE9OXCIpXG4gIHJldHVybiBkYlxufVxuXG4vKipcbiAqIOODiOODqeODs+OCtuOCr+OCt+ODp+ODs+OCkuS9v+eUqOOBl+OBpuODh+ODvOOCv+ODmeODvOOCueaTjeS9nOOCkuihjOOBhumWouaVsFxuICogQHBhcmFtIGNhbGxiYWNrIOODiOODqeODs+OCtuOCr+OCt+ODp+ODs+WGheOBp+Wun+ihjOOBmeOCi+OCs+ODvOODq+ODkOODg+OCr+mWouaVsFxuICogQHJldHVybnMg44Kz44O844Or44OQ44OD44Kv6Zai5pWw44Gu5oi744KK5YCkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3aXRoVHJhbnNhY3Rpb248VD4oY2FsbGJhY2s6IChkYjogYW55KSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcblxuICB0cnkge1xuICAgIC8vIOODiOODqeODs+OCtuOCr+OCt+ODp+ODs+mWi+Wni1xuICAgIGF3YWl0IGRiLnJ1bihcIkJFR0lOIFRSQU5TQUNUSU9OXCIpXG5cbiAgICAvLyDjgrPjg7zjg6vjg5Djg4Pjgq/plqLmlbDjgpLlrp/ooYxcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjYWxsYmFjayhkYilcblxuICAgIC8vIOODiOODqeODs+OCtuOCr+OCt+ODp+ODs+OCkuOCs+ODn+ODg+ODiFxuICAgIGF3YWl0IGRiLnJ1bihcIkNPTU1JVFwiKVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIC8vIOOCqOODqeODvOOBjOeZuueUn+OBl+OBn+WgtOWQiOOBr+ODreODvOODq+ODkOODg+OCr1xuICAgIGF3YWl0IGRiLnJ1bihcIlJPTExCQUNLXCIpXG4gICAgdGhyb3cgZXJyb3JcbiAgfSBmaW5hbGx5IHtcbiAgICAvLyDjg4fjg7zjgr/jg5njg7zjgrnmjqXntprjgpLplonjgZjjgotcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuXG4vKipcbiAqIOW+k+alreWToeODh+ODvOOCv+OCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHJldHVybnMg5b6T5qWt5ZOh44OH44O844K/44Gu6YWN5YiXXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbXBsb3llZXMoKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuYWxsKFwiU0VMRUNUICogRlJPTSBlbXBsb3llZXMgT1JERVIgQlkgZW1wbG95ZWVOdW1iZXJcIilcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDjg5fjg63jgrjjgqfjgq/jg4jjg4fjg7zjgr/jgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEByZXR1cm5zIOODl+ODreOCuOOCp+OCr+ODiOODh+ODvOOCv+OBrumFjeWIl1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdHMoKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuYWxsKFwiU0VMRUNUICogRlJPTSBwcm9qZWN0cyBPUkRFUiBCWSBwcm9qZWN0TnVtYmVyXCIpXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog5rS75YuV44K/44Kk44OX44OH44O844K/44KS5Y+W5b6X44GZ44KL6Zai5pWwXG4gKiBAcGFyYW0gZGJOYW1lIOOCquODl+OCt+ODp+ODs++8muODh+ODvOOCv+ODmeODvOOCueWQjVxuICogQHJldHVybnMg5rS75YuV44K/44Kk44OX44OH44O844K/44Gu6YWN5YiXXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY3Rpdml0eVR5cGVzKGRiTmFtZT86IHN0cmluZykge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbihkYk5hbWUpXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLmFsbChcIlNFTEVDVCAqIEZST00gbV9hY3Rpdml0eV90eXBlcyBPUkRFUiBCWSBkaXNwbGF5T3JkZXIsIHR5cGVDb2RlXCIpXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog54++5Zyo44Gu44Om44O844K244O8SUTjgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEByZXR1cm5zIOePvuWcqOOBruODpuODvOOCtuODvElE77yI5paH5a2X5YiX77yJ44G+44Gf44GvbnVsbFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXJJZCgpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHNldHRpbmcgPSBhd2FpdCBkYi5nZXQoXCJTRUxFQ1QgdmFsdWUgRlJPTSBhcHBfc2V0dGluZ3MgV0hFUkUga2V5ID0gJ05vd191c2VySUQnXCIpXG4gICAgcmV0dXJuIHNldHRpbmcgPyBzZXR0aW5nLnZhbHVlIDogbnVsbFxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG4vKipcbiAqIOePvuWcqOOBruODpuODvOOCtuODvOaDheWgseOCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHJldHVybnMg44Om44O844K244O85oOF5aCxXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDdXJyZW50VXNlcigpIHtcbiAgY29uc3QgdXNlcklkID0gYXdhaXQgZ2V0Q3VycmVudFVzZXJJZCgpXG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgZGIuZ2V0KFwiU0VMRUNUICogRlJPTSBlbXBsb3llZXMgV0hFUkUgZW1wbG95ZWVOdW1iZXIgPSA/XCIsIFt1c2VySWRdKVxuICAgIHJldHVybiB1c2VyIHx8IG51bGxcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDnj77lnKjjga7jg6bjg7zjgrbjg7xJROOCkuioreWumuOBmeOCi+mWouaVsFxuICogQHBhcmFtIHVzZXJJZCDoqK3lrprjgZnjgovjg6bjg7zjgrbjg7xJRFxuICogQHJldHVybnMg6Kit5a6a44GM5oiQ5Yqf44GX44Gf44GL44Gp44GG44GLXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZXRDdXJyZW50VXNlcklkKHVzZXJJZCkge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgYXdhaXQgZGIucnVuKFwiSU5TRVJUIE9SIFJFUExBQ0UgSU5UTyBhcHBfc2V0dGluZ3MgKGtleSwgdmFsdWUsIGRlc2NyaXB0aW9uKSBWQUxVRVMgKD8sID8sID8pXCIsIFtcbiAgICAgIFwiTm93X3VzZXJJRFwiLFxuICAgICAgdXNlcklkLFxuICAgICAgXCLnj77lnKjjg63jgrDjgqTjg7PkuK3jga7jg6bjg7zjgrbjg7xJRFwiLFxuICAgIF0pXG4gICAgcmV0dXJuIHRydWVcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDnibnlrprjga7lubTmnIjjga7lrp/nuL7jg4fjg7zjgr/jgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEBwYXJhbSB5ZWFyIOW5tFxuICogQHBhcmFtIG1vbnRoIOaciFxuICogQHJldHVybnMg5a6f57i+44OH44O844K/44Gu6YWN5YiXXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY2hpZXZlbWVudHNCeU1vbnRoKHllYXIsIG1vbnRoKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGFydERhdGUgPSBgJHt5ZWFyfS0ke21vbnRoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfS0wMSAwMDowMDowMGBcbiAgICBjb25zdCBuZXh0TW9udGggPSBtb250aCA9PT0gMTIgPyAxIDogbW9udGggKyAxXG4gICAgY29uc3QgbmV4dFllYXIgPSBtb250aCA9PT0gMTIgPyB5ZWFyICsgMSA6IHllYXJcbiAgICBjb25zdCBlbmREYXRlID0gYCR7bmV4dFllYXJ9LSR7bmV4dE1vbnRoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfS0wMSAwMDowMDowMGBcblxuICAgIHJldHVybiBhd2FpdCBkYi5hbGwoXG4gICAgICBcIlNFTEVDVCAqIEZST00gbWFpbl9aaXNzZWtpIFdIRVJFIHN0YXJ0RGF0ZVRpbWUgPj0gPyBBTkQgc3RhcnREYXRlVGltZSA8ID8gT1JERVIgQlkgc3RhcnREYXRlVGltZVwiLFxuICAgICAgW3N0YXJ0RGF0ZSwgZW5kRGF0ZV0sXG4gICAgKVxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG4vKipcbiAqIOeJueWumuOBruW5tOOBqOmAseOBruWun+e4vuODh+ODvOOCv+OCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHBhcmFtIHllYXIg5bm0XG4gKiBAcGFyYW0gd2VlayDpgLHnlarlj7dcbiAqIEByZXR1cm5zIOWun+e4vuODh+ODvOOCv+OBrumFjeWIl1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNoaWV2ZW1lbnRzQnlXZWVrKHllYXIsIHdlZWspIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHsgc3RhcnREYXRlLCBlbmREYXRlIH0gPSBnZXRXZWVrRGF0ZXMoeWVhciwgd2VlaylcbiAgICBjb25zdCBzdGFydERhdGVTdHIgPSBmb3JtYXREYXRlKHN0YXJ0RGF0ZSkgKyBcIiAwMDowMDowMFwiXG4gICAgY29uc3QgZW5kRGF0ZVN0ciA9IGZvcm1hdERhdGUobmV3IERhdGUoZW5kRGF0ZS5nZXRUaW1lKCkgKyA4NjQwMDAwMCkpICsgXCIgMDA6MDA6MDBcIlxuXG4gICAgLy8g54++5Zyo44Gu44Om44O844K244O8SUTjgpLlj5blvpdcbiAgICBjb25zdCBjdXJyZW50VXNlcklkID0gYXdhaXQgZ2V0Q3VycmVudFVzZXJJZCgpXG5cbiAgICAvLyDlj5blvpfjgZnjgovjg4fjg7zjgr/jga7jg5XjgqPjg7zjg6vjg4njgpLmmI7npLrnmoTjgavmjIflrppcbiAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgZGIuYWxsKFxuICAgICAgYFNFTEVDVCBcbiAgICAgICAga2V5SUQsIGVtcGxveWVlTnVtYmVyLCBzdGFydERhdGVUaW1lLCBlbmREYXRlVGltZSwgc3ViamVjdCwgY29udGVudCwgXG4gICAgICAgIHR5cGUsIG9yZ2FuaXplciwgcHJvamVjdE51bWJlciwgcG9zaXRpb24sIGZhY2lsaXR5LCBzdGF0dXMsIFxuICAgICAgICBidXNpbmVzc0NvZGUsIGRlcGFydG1lbnRDb2RlLCB3ZWVrQ29kZSwgXG4gICAgICAgIGNsYXNzaWZpY2F0aW9uMSwgY2xhc3NpZmljYXRpb24yLCBjbGFzc2lmaWNhdGlvbjMsIGNsYXNzaWZpY2F0aW9uNCwgXG4gICAgICAgIGNsYXNzaWZpY2F0aW9uNSwgY2xhc3NpZmljYXRpb242LCBjbGFzc2lmaWNhdGlvbjcsIGNsYXNzaWZpY2F0aW9uOCwgY2xhc3NpZmljYXRpb245XG4gICAgICBGUk9NIG1haW5fWmlzc2VraSBcbiAgICAgIFdIRVJFIGVtcGxveWVlTnVtYmVyID0gPyBBTkQgc3RhcnREYXRlVGltZSA+PSA/IEFORCBzdGFydERhdGVUaW1lIDwgPyBcbiAgICAgIE9SREVSIEJZIHN0YXJ0RGF0ZVRpbWVgLFxuICAgICAgW2N1cnJlbnRVc2VySWQsIHN0YXJ0RGF0ZVN0ciwgZW5kRGF0ZVN0cl0sXG4gICAgKVxuXG4gICAgcmV0dXJuIHJlc3VsdHNcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDlrp/nuL7jg4fjg7zjgr/jgpLov73liqDjgZnjgovplqLmlbBcbiAqIEBwYXJhbSBhY2hpZXZlbWVudCDlrp/nuL7jg4fjg7zjgr/jgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEByZXR1cm5zIOaMv+WFpeOBleOCjOOBn+ODh+ODvOOCv+OBrklEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRBY2hpZXZlbWVudChhY2hpZXZlbWVudCkge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgY29sdW1ucyA9IE9iamVjdC5rZXlzKGFjaGlldmVtZW50KS5qb2luKFwiLCBcIilcbiAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBPYmplY3Qua2V5cyhhY2hpZXZlbWVudClcbiAgICAgIC5tYXAoKCkgPT4gXCI/XCIpXG4gICAgICAuam9pbihcIiwgXCIpXG4gICAgY29uc3QgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyhhY2hpZXZlbWVudClcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnJ1bihgSU5TRVJUIElOVE8gbWFpbl9aaXNzZWtpICgke2NvbHVtbnN9KSBWQUxVRVMgKCR7cGxhY2Vob2xkZXJzfSlgLCB2YWx1ZXMpXG5cbiAgICByZXR1cm4gYWNoaWV2ZW1lbnQua2V5SURcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDlrp/nuL7jg4fjg7zjgr/jgpLmm7TmlrDjgZnjgovplqLmlbBcbiAqIEBwYXJhbSBrZXlJRCDmm7TmlrDjgZnjgovjg4fjg7zjgr/jga5JRFxuICogQHBhcmFtIGFjaGlldmVtZW50IOabtOaWsOOBmeOCi+Wun+e4vuODh+ODvOOCv+OCquODluOCuOOCp+OCr+ODiFxuICogQHJldHVybnMg5pu05paw44GM5oiQ5Yqf44GX44Gf44GL44Gp44GG44GLXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVBY2hpZXZlbWVudChrZXlJRCwgYWNoaWV2ZW1lbnQpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHNldENsYXVzZSA9IE9iamVjdC5rZXlzKGFjaGlldmVtZW50KVxuICAgICAgLm1hcCgoa2V5KSA9PiBgJHtrZXl9ID0gP2ApXG4gICAgICAuam9pbihcIiwgXCIpXG4gICAgY29uc3QgdmFsdWVzID0gWy4uLk9iamVjdC52YWx1ZXMoYWNoaWV2ZW1lbnQpLCBrZXlJRF1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnJ1bihgVVBEQVRFIG1haW5fWmlzc2VraSBTRVQgJHtzZXRDbGF1c2V9IFdIRVJFIGtleUlEID0gP2AsIHZhbHVlcylcblxuICAgIHJldHVybiByZXN1bHQuY2hhbmdlcyA+IDBcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDlrp/nuL7jg4fjg7zjgr/jgpLliYrpmaTjgZnjgovplqLmlbBcbiAqIEBwYXJhbSBrZXlJRCDliYrpmaTjgZnjgovjg4fjg7zjgr/jga5JRFxuICogQHJldHVybnMg5YmK6Zmk44GM5oiQ5Yqf44GX44Gf44GL44Gp44GG44GLXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVBY2hpZXZlbWVudChrZXlJRCkge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucnVuKFwiREVMRVRFIEZST00gbWFpbl9aaXNzZWtpIFdIRVJFIGtleUlEID0gP1wiLCBba2V5SURdKVxuICAgIHJldHVybiByZXN1bHQuY2hhbmdlcyA+IDBcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDjg6bjg7zjgrbjg7zjga7jg5fjg63jgrjjgqfjgq/jg4jjg6rjgrnjg4jjgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEBwYXJhbSB1c2VySUQg44Om44O844K244O8SURcbiAqIEBwYXJhbSBwcm9qZWN0Q29kZSDnibnlrprjga7jg5fjg63jgrjjgqfjgq/jg4jjgrPjg7zjg4nvvIjjgqrjg5fjgrfjg6fjg7PvvIlcbiAqIEByZXR1cm5zIOODl+ODreOCuOOCp+OCr+ODiOOBrumFjeWIl1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclByb2plY3RzKHVzZXJJRDogc3RyaW5nLCBwcm9qZWN0Q29kZT86IHN0cmluZyB8IG51bGwpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIC8vIHByb2plY3RfbWVtYmVyX2hpc3Rvcmllc+ODhuODvOODluODq+OBi+OCieODh+ODvOOCv+OCkuWPluW+l1xuICAgIGxldCBxdWVyeSA9IGBcbiAgICAgIFNFTEVDVCBcbiAgICAgICAgcG1oLiosXG4gICAgICAgIHAucHJvamVjdE51bWJlcixcbiAgICAgICAgcC5uYW1lIGFzIHByb2plY3ROYW1lLFxuICAgICAgICBwLmNsaWVudE5hbWUsXG4gICAgICAgIHAuY2xhc3NpZmljYXRpb24sXG4gICAgICAgIHAuc3RhdHVzLFxuICAgICAgICBwLmlzUHJvamVjdCxcbiAgICAgICAgcC5wcm9qZWN0TnVtYmVyIGFzIHByb2plY3RDb2RlLFxuICAgICAgICBwbWgucm9sZSxcbiAgICAgICAgcG1oLnN0YXJ0X2RhdGUgYXMgc3RhcnREYXRlXG4gICAgICBGUk9NIHByb2plY3RfbWVtYmVyX2hpc3RvcmllcyBwbWhcbiAgICAgIElOTkVSIEpPSU4gcHJvamVjdHMgcCBPTiBwbWgucHJvamVjdF9pZCA9IHAucHJvamVjdE51bWJlclxuICAgICAgV0hFUkUgcG1oLnVzZXJfaWQgPSA/XG4gICAgICBBTkQgKHBtaC5lbmRfZGF0ZSBJUyBOVUxMIE9SIHBtaC5lbmRfZGF0ZSA+IGRhdGUoJ25vdycpKVxuICAgIGBcbiAgICBjb25zdCBwYXJhbXMgPSBbdXNlcklEXVxuXG4gICAgLy8g44OX44Ot44K444Kn44Kv44OI44Kz44O844OJ44GM5oyH5a6a44GV44KM44Gm44GE44KL5aC05ZCI44Gv5p2h5Lu244KS6L+95YqgXG4gICAgaWYgKHByb2plY3RDb2RlKSB7XG4gICAgICBxdWVyeSArPSBcIiBBTkQgcG1oLnByb2plY3RfaWQgPSA/XCJcbiAgICAgIHBhcmFtcy5wdXNoKHByb2plY3RDb2RlKVxuICAgIH1cblxuICAgIHF1ZXJ5ICs9IFwiIE9SREVSIEJZIHAucHJvamVjdE51bWJlciBBU0NcIlxuXG4gICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IGRiLmFsbChxdWVyeSwgcGFyYW1zKVxuICAgIFxuICAgIC8vIOe1kOaenOOBjOepuuOBruWgtOWQiOOBruOBv+ODreOCsOOCkuWHuuWKm1xuICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc29sZS5sb2coJ+ODl+ODreOCuOOCp+OCr+ODiOOBjOimi+OBpOOBi+OCiuOBvuOBm+OCk+OBp+OBl+OBn+OAgicpXG4gICAgICBjb25zb2xlLmxvZygnU1FMOicsIHF1ZXJ5KVxuICAgICAgY29uc29sZS5sb2coJ+ODkeODqeODoeODvOOCvzonLCBwYXJhbXMpXG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdHNcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfjg5fjg63jgrjjgqfjgq/jg4jlj5blvpfkuK3jgavjgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ86JywgZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDjg5fjg63jgrjjgqfjgq/jg4jjga7oqK3lgpnnlarlj7fjg6rjgrnjg4jjgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEBwYXJhbSBwcm9qZWN0Q29kZSDjg5fjg63jgrjjgqfjgq/jg4jjgrPjg7zjg4lcbiAqIEByZXR1cm5zIOioreWCmeeVquWPt+OBrumFjeWIl1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdEVxdWlwbWVudE51bWJlcnMocHJvamVjdENvZGU6IHN0cmluZykge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgLy8g55u05o6lcHJvamVjdHPjg4bjg7zjg5bjg6vjgYvjgonlj5blvpdcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBkYi5nZXQoXCJTRUxFQ1QgZXF1aXBtZW50TnVtYmVycyBGUk9NIHByb2plY3RzIFdIRVJFIHByb2plY3ROdW1iZXIgPSA/XCIsIFtwcm9qZWN0Q29kZV0pXG5cbiAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5lcXVpcG1lbnROdW1iZXJzKSB7XG4gICAgICByZXR1cm4gcmVzdWx0LmVxdWlwbWVudE51bWJlcnMuc3BsaXQoXCIsXCIpLm1hcCgoaXRlbTogc3RyaW5nKSA9PiBpdGVtLnRyaW0oKSlcbiAgICB9XG4gICAgcmV0dXJuIFtdXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog44OX44Ot44K444Kn44Kv44OI44Gu6LO85YWl5ZOB44Oq44K544OI44KS5Y+W5b6X44GZ44KL6Zai5pWwXG4gKiBAcGFyYW0gcHJvamVjdElkIOODl+ODreOCuOOCp+OCr+ODiElEXG4gKiBAcGFyYW0gZXF1aXBtZW50TnVtYmVyIOioreWCmeeVquWPt1xuICogQHJldHVybnMg6LO85YWl5ZOB44Gu6YWN5YiXXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRQcm9qZWN0UHVyY2hhc2VJdGVtcyhwcm9qZWN0SWQ6IHN0cmluZywgZXF1aXBtZW50TnVtYmVyOiBzdHJpbmcpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLmFsbChcbiAgICAgIFwiU0VMRUNUICogRlJPTSBwcm9qZWN0X3B1cmNoYXNlX2l0ZW1zIFdIRVJFIHByb2plY3RfaWQgPSA/IEFORCBlcXVpcG1lbnROdW1iZXIgPSA/IE9SREVSIEJZIHNlcXVlbmNlTnVtYmVyXCIsXG4gICAgICBbcHJvamVjdElkLCBlcXVpcG1lbnROdW1iZXJdLFxuICAgIClcbiAgICByZXR1cm4gcmVzdWx0XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign44OX44Ot44K444Kn44Kv44OI6LO85YWl5ZOB44Gu5Y+W5b6X5Lit44Gr44Ko44Op44O844GM55m655Sf44GX44G+44GX44GfOicsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog44Om44O844K244O844OX44Ot44K444Kn44Kv44OI6Zai6YCj44KS6L+95Yqg44GZ44KL6Zai5pWwXG4gKiBAcGFyYW0gdXNlcklEIOODpuODvOOCtuODvElEXG4gKiBAcGFyYW0gcHJvamVjdENvZGUg44OX44Ot44K444Kn44Kv44OI44Kz44O844OJXG4gKiBAcGFyYW0gcm9sZSDlvbnlibJcbiAqIEByZXR1cm5zIOaMv+WFpeOBleOCjOOBn+ODh+ODvOOCv+OBrklEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRVc2VyUHJvamVjdCh1c2VySUQ6IHN0cmluZywgcHJvamVjdENvZGU6IHN0cmluZywgcm9sZTogc3RyaW5nKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKClcbiAgdHJ5IHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zcGxpdChcIlRcIilbMF1cbiAgICBcbiAgICAvLyDml6LlrZjjga7jg6Hjg7Pjg5Djg7zjgrfjg4Pjg5fjgpLjg4Hjgqfjg4Pjgq9cbiAgICBjb25zdCBleGlzdGluZ01lbWJlciA9IGF3YWl0IGRiLmdldChcbiAgICAgIGBTRUxFQ1QgKiBGUk9NIHByb2plY3RfbWVtYmVyX2hpc3RvcmllcyBcbiAgICAgICBXSEVSRSB1c2VyX2lkID0gPyBBTkQgcHJvamVjdF9pZCA9ID8gXG4gICAgICAgQU5EIChlbmRfZGF0ZSBJUyBOVUxMIE9SIGVuZF9kYXRlID4gZGF0ZSgnbm93JykpYCxcbiAgICAgIFt1c2VySUQsIHByb2plY3RDb2RlXVxuICAgIClcbiAgICBcbiAgICBpZiAoZXhpc3RpbmdNZW1iZXIpIHtcbiAgICAgIC8vIOaXouWtmOOBruODoeODs+ODkOODvOOCt+ODg+ODl+OBjOOBguOCi+WgtOWQiOOBr+W9ueWJsuOBruOBv+abtOaWsFxuICAgICAgYXdhaXQgZGIucnVuKFxuICAgICAgICBgVVBEQVRFIHByb2plY3RfbWVtYmVyX2hpc3RvcmllcyBcbiAgICAgICAgIFNFVCByb2xlID0gPyBcbiAgICAgICAgIFdIRVJFIHVzZXJfaWQgPSA/IEFORCBwcm9qZWN0X2lkID0gPyBBTkQgZW5kX2RhdGUgSVMgTlVMTGAsXG4gICAgICAgIFtyb2xlLCB1c2VySUQsIHByb2plY3RDb2RlXVxuICAgICAgKVxuICAgICAgcmV0dXJuIGAke3VzZXJJRH1fJHtwcm9qZWN0Q29kZX1gXG4gICAgfVxuICAgIFxuICAgIC8vIOaWsOOBl+OBhOODoeODs+ODkOODvOOCt+ODg+ODl+OCkui/veWKoFxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnJ1bihcbiAgICAgIGBJTlNFUlQgSU5UTyBwcm9qZWN0X21lbWJlcl9oaXN0b3JpZXMgKHVzZXJfaWQsIHByb2plY3RfaWQsIHN0YXJ0X2RhdGUsIHJvbGUpIFxuICAgICAgIFZBTFVFUyAoPywgPywgPywgPylgLFxuICAgICAgW3VzZXJJRCwgcHJvamVjdENvZGUsIHRvZGF5LCByb2xlXVxuICAgIClcbiAgICBcbiAgICByZXR1cm4gYCR7dXNlcklEfV8ke3Byb2plY3RDb2RlfWBcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDjg5fjg63jgrjjgqfjgq/jg4joqbPntLDjgpLov73liqDjgZnjgovplqLmlbBcbiAqIEBwYXJhbSBwcm9qZWN0RGV0YWlscyDjg5fjg63jgrjjgqfjgq/jg4joqbPntLDjgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEByZXR1cm5zIOaMv+WFpeOBleOCjOOBn+ODh+ODvOOCv+OBrklEXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9qZWN0RGV0YWlscyhwcm9qZWN0RGV0YWlscykge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgLy8gZXF1aXBtZW50TnVtYmVyc+OBjOmFjeWIl+OBruWgtOWQiOOAgeOCq+ODs+ODnuWMuuWIh+OCiuOBruaWh+Wtl+WIl+OBq+WkieaPm1xuICAgIGlmIChBcnJheS5pc0FycmF5KHByb2plY3REZXRhaWxzLmVxdWlwbWVudE51bWJlcnMpKSB7XG4gICAgICBwcm9qZWN0RGV0YWlscy5lcXVpcG1lbnROdW1iZXJzID0gcHJvamVjdERldGFpbHMuZXF1aXBtZW50TnVtYmVycy5qb2luKFwiLFwiKVxuICAgIH1cblxuICAgIGNvbnN0IGNvbHVtbnMgPSBPYmplY3Qua2V5cyhwcm9qZWN0RGV0YWlscykuam9pbihcIiwgXCIpXG4gICAgY29uc3QgcGxhY2Vob2xkZXJzID0gT2JqZWN0LmtleXMocHJvamVjdERldGFpbHMpXG4gICAgICAubWFwKCgpID0+IFwiP1wiKVxuICAgICAgLmpvaW4oXCIsIFwiKVxuICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMocHJvamVjdERldGFpbHMpXG5cbiAgICAvLyBwcm9qZWN0c+ODhuODvOODluODq+OBq+ebtOaOpeaMv+WFpVxuICAgIGF3YWl0IGRiLnJ1bihgSU5TRVJUIE9SIFJFUExBQ0UgSU5UTyBwcm9qZWN0cyAoJHtjb2x1bW5zfSkgVkFMVUVTICgke3BsYWNlaG9sZGVyc30pYCwgdmFsdWVzKVxuICAgIHJldHVybiBwcm9qZWN0RGV0YWlscy5wcm9qZWN0TnVtYmVyXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog44OX44Ot44K444Kn44Kv44OI6LO85YWl5ZOB44KS6L+95Yqg44GZ44KL6Zai5pWwXG4gKiBAcGFyYW0gcHVyY2hhc2VJdGVtIOizvOWFpeWTgeOCquODluOCuOOCp+OCr+ODiFxuICogQHJldHVybnMg5oy/5YWl44GV44KM44Gf44OH44O844K/44Gu6KSH5ZCI5Li744Kt44O8XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9qZWN0UHVyY2hhc2VJdGVtKHB1cmNoYXNlSXRlbSkge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgLy8g5qyh44Gu6YCj55Wq44KS5Y+W5b6XXG4gICAgaWYgKCFwdXJjaGFzZUl0ZW0uc2VxdWVuY2VOdW1iZXIpIHtcbiAgICAgIGNvbnN0IG5leHRTZXEgPSBhd2FpdCBnZXROZXh0UHVyY2hhc2VJdGVtU2VxdWVuY2UoZGIsIHB1cmNoYXNlSXRlbS5wcm9qZWN0X2lkLCBwdXJjaGFzZUl0ZW0uZXF1aXBtZW50TnVtYmVyKVxuICAgICAgcHVyY2hhc2VJdGVtLnNlcXVlbmNlTnVtYmVyID0gbmV4dFNlcS50b1N0cmluZygpLnBhZFN0YXJ0KDMsIFwiMFwiKVxuICAgIH1cbiAgICAvLyBrZXlJROOBrueUn+aIkOODu+WIqeeUqOOBr+S4jeimgVxuICAgIGNvbnN0IGNvbHVtbnMgPSBPYmplY3Qua2V5cyhwdXJjaGFzZUl0ZW0pLmpvaW4oXCIsIFwiKVxuICAgIGNvbnN0IHBsYWNlaG9sZGVycyA9IE9iamVjdC5rZXlzKHB1cmNoYXNlSXRlbSlcbiAgICAgIC5tYXAoKCkgPT4gXCI/XCIpXG4gICAgICAuam9pbihcIiwgXCIpXG4gICAgY29uc3QgdmFsdWVzID0gT2JqZWN0LnZhbHVlcyhwdXJjaGFzZUl0ZW0pXG5cbiAgICBhd2FpdCBkYi5ydW4oYElOU0VSVCBPUiBSRVBMQUNFIElOVE8gcHJvamVjdF9wdXJjaGFzZV9pdGVtcyAoJHtjb2x1bW5zfSkgVkFMVUVTICgke3BsYWNlaG9sZGVyc30pYCwgdmFsdWVzKVxuICAgIC8vIOikh+WQiOS4u+OCreODvOOCkui/lOOBmVxuICAgIHJldHVybiB7XG4gICAgICBwcm9qZWN0X2lkOiBwdXJjaGFzZUl0ZW0ucHJvamVjdF9pZCxcbiAgICAgIGVxdWlwbWVudE51bWJlcjogcHVyY2hhc2VJdGVtLmVxdWlwbWVudE51bWJlcixcbiAgICAgIHNlcXVlbmNlTnVtYmVyOiBwdXJjaGFzZUl0ZW0uc2VxdWVuY2VOdW1iZXJcbiAgICB9XG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICog5qyh44Gu6LO85YWl5ZOB6YCj55Wq44KS5Y+W5b6X44GZ44KL6Zai5pWwXG4gKiBAcGFyYW0gZGIg44OH44O844K/44OZ44O844K55o6l57aaXG4gKiBAcGFyYW0gcHJvamVjdElkIOODl+ODreOCuOOCp+OCr+ODiElEXG4gKiBAcGFyYW0gZXF1aXBtZW50TnVtYmVyIOioreWCmeeVquWPt1xuICogQHJldHVybnMg5qyh44Gu6YCj55WqXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldE5leHRQdXJjaGFzZUl0ZW1TZXF1ZW5jZShkYiwgcHJvamVjdElkLCBlcXVpcG1lbnROdW1iZXIpIHtcbiAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIuZ2V0KFxuICAgIFwiU0VMRUNUIE1BWChDQVNUKHNlcXVlbmNlTnVtYmVyIEFTIElOVEVHRVIpKSBhcyBtYXhTZXEgRlJPTSBwcm9qZWN0X3B1cmNoYXNlX2l0ZW1zIFdIRVJFIHByb2plY3RfaWQgPSA/IEFORCBlcXVpcG1lbnROdW1iZXIgPSA/XCIsXG4gICAgW3Byb2plY3RJZCwgZXF1aXBtZW50TnVtYmVyXSxcbiAgKVxuICBpZiAocmVzdWx0ICYmIHJlc3VsdC5tYXhTZXEgIT09IG51bGwpIHtcbiAgICByZXR1cm4gcmVzdWx0Lm1heFNlcSArIDFcbiAgfVxuICByZXR1cm4gMVxufVxuXG4vLyDpgLHjga7plovlp4vml6XjgajntYLkuobml6XjgpLlj5blvpfjgZnjgovplqLmlbBcbmZ1bmN0aW9uIGdldFdlZWtEYXRlcyh5ZWFyLCB3ZWVrKSB7XG4gIGNvbnN0IGZpcnN0RGF5T2ZZZWFyID0gbmV3IERhdGUoeWVhciwgMCwgMSlcbiAgY29uc3QgZGF5c09mZnNldCA9IGZpcnN0RGF5T2ZZZWFyLmdldERheSgpID09PSAwID8gNiA6IGZpcnN0RGF5T2ZZZWFyLmdldERheSgpIC0gMVxuICBjb25zdCBmaXJzdFdlZWtEYXkgPSBuZXcgRGF0ZSh5ZWFyLCAwLCAxICsgKHdlZWsgLSAxKSAqIDcgLSBkYXlzT2Zmc2V0KVxuICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZShmaXJzdFdlZWtEYXkpXG4gIHN0YXJ0RGF0ZS5zZXREYXRlKGZpcnN0V2Vla0RheS5nZXREYXRlKCkgLSBmaXJzdFdlZWtEYXkuZ2V0RGF5KCkpXG4gIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZShzdGFydERhdGUpXG4gIGVuZERhdGUuc2V0RGF0ZShzdGFydERhdGUuZ2V0RGF0ZSgpICsgNilcbiAgcmV0dXJuIHsgc3RhcnREYXRlLCBlbmREYXRlIH1cbn1cblxuLy8g5pel5LuY44KSWVlZWS1NTS1EROW9ouW8j+OBq+ODleOCqeODvOODnuODg+ODiOOBmeOCi+mWouaVsFxuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlKSB7XG4gIHJldHVybiBgJHtkYXRlLmdldEZ1bGxZZWFyKCl9LSR7KGRhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfS0ke2RhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpfWBcbn1cblxuLyoqXG4gKiDjg4bjg7zjg5bjg6vjga7jgqvjg6njg6Dmg4XloLHjgpLlj5blvpfjgZnjgovplqLmlbBcbiAqIEBwYXJhbSB0YWJsZU5hbWUg44OG44O844OW44Or5ZCNXG4gKiBAcmV0dXJucyDjgqvjg6njg6Dmg4XloLHjga7phY3liJdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRhYmxlQ29sdW1ucyh0YWJsZU5hbWU6IHN0cmluZykge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLmFsbChgUFJBR01BIHRhYmxlX2luZm8oJHt0YWJsZU5hbWV9KWApXG4gIH0gZmluYWxseSB7XG4gICAgYXdhaXQgZGIuY2xvc2UoKVxuICB9XG59XG5cbi8qKlxuICogbV9hY3Rpdml0eV90eXBlc+ODhuODvOODluODq+OBruOCq+ODqeODoOaDheWgseOCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHBhcmFtIGRiTmFtZSDjgqrjg5fjgrfjg6fjg7PvvJrjg4fjg7zjgr/jg5njg7zjgrnlkI1cbiAqIEBwYXJhbSB0YWJsZU5hbWUg44Kq44OX44K344On44Oz77ya44OG44O844OW44Or5ZCN77yI44OH44OV44Kp44Or44OI44GvbV9hY3Rpdml0eV90eXBlc++8iVxuICogQHJldHVybnMg44Kr44Op44Og5oOF5aCx44Gu6YWN5YiX77yI5ZCN5YmN44Go5pel5pys6Kqe5ZCN44Gu44Oe44OD44OU44Oz44Kw44KS5ZCr44KA77yJXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBY3Rpdml0eVR5cGVDb2x1bW5zKGRiTmFtZT86IHN0cmluZywgdGFibGVOYW1lOiBzdHJpbmcgPSAnbV9hY3Rpdml0eV90eXBlcycpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oZGJOYW1lKVxuICB0cnkge1xuICAgIGNvbnN0IGNvbHVtbnMgPSBhd2FpdCBkYi5hbGwoYFBSQUdNQSB0YWJsZV9pbmZvKCR7dGFibGVOYW1lfSlgKVxuICAgIFxuICAgIC8vIOOCq+ODqeODoOWQjeOBqOaXpeacrOiqnuihqOekuuWQjeOBruODnuODg+ODlOODs+OCsFxuICAgIGNvbnN0IGNvbHVtbk5hbWVNYXAgPSB7XG4gICAgICB0eXBlQ29kZTogXCLjgrPjg7zjg4lcIixcbiAgICAgIHR5cGVOYW1lOiBcIuWQjeensFwiLFxuICAgICAgZGVzY3JpcHRpb246IFwi6Kqs5piOXCIsXG4gICAgICBjYXRlZ29yeTogXCLlpKfliIbpoZ5cIixcbiAgICAgIHN1YkNhdGVnb3J5OiBcIuS4reWIhumhnlwiLFxuICAgICAgZGlzcGxheU9yZGVyOiBcIuihqOekuumghlwiLFxuICAgICAgY29sb3I6IFwi6ImyXCIsXG4gICAgICBpc0FjdGl2ZTogXCLnirbmhYtcIlxuICAgIH1cbiAgICBcbiAgICAvLyDooajnpLrjgZfjgarjgYTjgrfjgrnjg4bjg6DliJfjgoRJROWIl1xuICAgIGNvbnN0IGV4Y2x1ZGVkQ29sdW1ucyA9IFsnaWQnLCAnY3JlYXRlZF9hdCcsICd1cGRhdGVkX2F0J11cbiAgICBcbiAgICByZXR1cm4gY29sdW1uc1xuICAgICAgLmZpbHRlcihjb2wgPT4gIWV4Y2x1ZGVkQ29sdW1ucy5pbmNsdWRlcyhjb2wubmFtZSkpXG4gICAgICAubWFwKGNvbCA9PiAoe1xuICAgICAgICBpZDogY29sLm5hbWUsXG4gICAgICAgIG5hbWU6IGNvbHVtbk5hbWVNYXBbY29sLm5hbWVdIHx8IGNvbC5uYW1lLFxuICAgICAgICBkYXRhVHlwZTogY29sLnR5cGUsXG4gICAgICAgIHZpc2libGU6IE9iamVjdC5rZXlzKGNvbHVtbk5hbWVNYXApLmluY2x1ZGVzKGNvbC5uYW1lKSAvLyDjg4fjg5Xjgqnjg6vjg4jjgafooajnpLrjgZnjgovliJdcbiAgICAgIH0pKVxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG4vKipcbiAqIOa0u+WLleOCv+OCpOODl+OCkui/veWKoOOBmeOCi+mWouaVsFxuICogQHBhcmFtIGFjdGl2aXR5VHlwZSDov73liqDjgZnjgovmtLvli5Xjgr/jgqTjg5fjg4fjg7zjgr/jgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEBwYXJhbSBkYk5hbWUg44Kq44OX44K344On44Oz77ya44OH44O844K/44OZ44O844K55ZCNXG4gKiBAcmV0dXJucyDov73liqDjgZfjgZ/mtLvli5Xjgr/jgqTjg5fjg4fjg7zjgr9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZEFjdGl2aXR5VHlwZShhY3Rpdml0eVR5cGU6IGFueSwgZGJOYW1lPzogc3RyaW5nKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKGRiTmFtZSlcbiAgdHJ5IHtcbiAgICBjb25zdCBjb2x1bW5zID0gT2JqZWN0LmtleXMoYWN0aXZpdHlUeXBlKS5qb2luKFwiLCBcIilcbiAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBPYmplY3Qua2V5cyhhY3Rpdml0eVR5cGUpXG4gICAgICAubWFwKCgpID0+IFwiP1wiKVxuICAgICAgLmpvaW4oXCIsIFwiKVxuICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC52YWx1ZXMoYWN0aXZpdHlUeXBlKVxuXG4gICAgYXdhaXQgZGIucnVuKGBJTlNFUlQgSU5UTyBtX2FjdGl2aXR5X3R5cGVzICgke2NvbHVtbnN9KSBWQUxVRVMgKCR7cGxhY2Vob2xkZXJzfSlgLCB2YWx1ZXMpXG4gICAgXG4gICAgLy8g6L+95Yqg44GX44Gf44OH44O844K/44KS6L+U44GZXG4gICAgcmV0dXJuIGFjdGl2aXR5VHlwZVxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG4vKipcbiAqIOa0u+WLleOCv+OCpOODl+OCkuabtOaWsOOBmeOCi+mWouaVsFxuICogQHBhcmFtIHR5cGVDb2RlIOabtOaWsOOBmeOCi+a0u+WLleOCv+OCpOODl+OBruOCs+ODvOODiVxuICogQHBhcmFtIGFjdGl2aXR5VHlwZSDmm7TmlrDjgZnjgovmtLvli5Xjgr/jgqTjg5fjg4fjg7zjgr/jgqrjg5bjgrjjgqfjgq/jg4hcbiAqIEBwYXJhbSBkYk5hbWUg44Kq44OX44K344On44Oz77ya44OH44O844K/44OZ44O844K55ZCNXG4gKiBAcmV0dXJucyDmm7TmlrDjgYzmiJDlip/jgZfjgZ/jgYvjganjgYbjgYtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUFjdGl2aXR5VHlwZSh0eXBlQ29kZTogc3RyaW5nLCBhY3Rpdml0eVR5cGU6IGFueSwgZGJOYW1lPzogc3RyaW5nKSB7XG4gIGNvbnN0IGRiID0gYXdhaXQgZ2V0RGJDb25uZWN0aW9uKGRiTmFtZSlcbiAgdHJ5IHtcbiAgICAvLyB0eXBlQ29kZeOBr+abtOaWsOWvvuixoeOBrueJueWumuOBq+S9v+eUqOOBmeOCi+OBn+OCgeOAgeabtOaWsOODh+ODvOOCv+OBi+OCiemZpOWkllxuICAgIGNvbnN0IHVwZGF0ZURhdGEgPSB7IC4uLmFjdGl2aXR5VHlwZSB9XG4gICAgZGVsZXRlIHVwZGF0ZURhdGEudHlwZUNvZGVcbiAgICBcbiAgICBjb25zdCBzZXRDbGF1c2UgPSBPYmplY3Qua2V5cyh1cGRhdGVEYXRhKVxuICAgICAgLm1hcCgoa2V5KSA9PiBgJHtrZXl9ID0gP2ApXG4gICAgICAuam9pbihcIiwgXCIpXG4gICAgY29uc3QgdmFsdWVzID0gWy4uLk9iamVjdC52YWx1ZXModXBkYXRlRGF0YSksIHR5cGVDb2RlXVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZGIucnVuKGBVUERBVEUgbV9hY3Rpdml0eV90eXBlcyBTRVQgJHtzZXRDbGF1c2V9IFdIRVJFIHR5cGVDb2RlID0gP2AsIHZhbHVlcylcblxuICAgIHJldHVybiByZXN1bHQuY2hhbmdlcyA+IDBcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCBkYi5jbG9zZSgpXG4gIH1cbn1cblxuLyoqXG4gKiDmtLvli5Xjgr/jgqTjg5fjgpLliYrpmaTjgZnjgovplqLmlbBcbiAqIEBwYXJhbSB0eXBlQ29kZSDliYrpmaTjgZnjgovmtLvli5Xjgr/jgqTjg5fjga7jgrPjg7zjg4lcbiAqIEBwYXJhbSBkYk5hbWUg44Kq44OX44K344On44Oz77ya44OH44O844K/44OZ44O844K55ZCNXG4gKiBAcmV0dXJucyDliYrpmaTjgYzmiJDlip/jgZfjgZ/jgYvjganjgYbjgYtcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUFjdGl2aXR5VHlwZSh0eXBlQ29kZTogc3RyaW5nLCBkYk5hbWU/OiBzdHJpbmcpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oZGJOYW1lKVxuICB0cnkge1xuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRiLnJ1bihcIkRFTEVURSBGUk9NIG1fYWN0aXZpdHlfdHlwZXMgV0hFUkUgdHlwZUNvZGUgPSA/XCIsIFt0eXBlQ29kZV0pXG4gICAgcmV0dXJuIHJlc3VsdC5jaGFuZ2VzID4gMFxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG4vKipcbiAqIOeJueWumuOBruW5tOaciOOBruODl+ODreOCuOOCp+OCr+ODiOOCs+ODvOODieWIpealreWLmembhuioiOODh+ODvOOCv+OCkuWPluW+l+OBmeOCi+mWouaVsFxuICogQHBhcmFtIHllYXIg5bm0XG4gKiBAcGFyYW0gbW9udGgg5pyIXG4gKiBAcmV0dXJucyDjg5fjg63jgrjjgqfjgq/jg4jjgrPjg7zjg4nliKXjga7mpa3li5npm4boqIjjg4fjg7zjgr9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFByb2plY3RTdW1tYXJ5QnlNb250aCh5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIpIHtcbiAgY29uc3QgZGIgPSBhd2FpdCBnZXREYkNvbm5lY3Rpb24oKVxuICB0cnkge1xuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IGAke3llYXJ9LSR7bW9udGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9LTAxIDAwOjAwOjAwYFxuICAgIGNvbnN0IG5leHRNb250aCA9IG1vbnRoID09PSAxMiA/IDEgOiBtb250aCArIDFcbiAgICBjb25zdCBuZXh0WWVhciA9IG1vbnRoID09PSAxMiA/IHllYXIgKyAxIDogeWVhclxuICAgIGNvbnN0IGVuZERhdGUgPSBgJHtuZXh0WWVhcn0tJHtuZXh0TW9udGgudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIil9LTAxIDAwOjAwOjAwYFxuXG4gICAgLy8g44OX44Ot44K444Kn44Kv44OI44Kz44O844OJ5Yil44Gu5qWt5YuZ5pmC6ZaT6ZuG6KiIXG4gICAgY29uc3QgcHJvamVjdFN1bW1hcnkgPSBhd2FpdCBkYi5hbGwoXG4gICAgICBgXG4gICAgICBTRUxFQ1QgXG4gICAgICAgIHoucHJvamVjdE51bWJlciwgXG4gICAgICAgIHAubmFtZSBhcyBwcm9qZWN0TmFtZSxcbiAgICAgICAgQ09VTlQoei5rZXlJRCkgYXMgdGFza0NvdW50LFxuICAgICAgICBTVU0oKGp1bGlhbmRheSh6LmVuZERhdGVUaW1lKSAtIGp1bGlhbmRheSh6LnN0YXJ0RGF0ZVRpbWUpKSAqIDI0KSBhcyB0b3RhbEhvdXJzLFxuICAgICAgICB6LnR5cGVcbiAgICAgIEZST00gXG4gICAgICAgIG1haW5fWmlzc2VraSB6XG4gICAgICBMRUZUIEpPSU5cbiAgICAgICAgcHJvamVjdHMgcCBPTiB6LnByb2plY3ROdW1iZXIgPSBwLnByb2plY3ROdW1iZXJcbiAgICAgIFdIRVJFIFxuICAgICAgICB6LnN0YXJ0RGF0ZVRpbWUgPj0gPyBBTkQgXG4gICAgICAgIHouc3RhcnREYXRlVGltZSA8ID9cbiAgICAgIEdST1VQIEJZIFxuICAgICAgICB6LnByb2plY3ROdW1iZXIsIHoudHlwZVxuICAgICAgT1JERVIgQlkgXG4gICAgICAgIHRvdGFsSG91cnMgREVTQ1xuICAgICAgYCxcbiAgICAgIFtzdGFydERhdGUsIGVuZERhdGVdXG4gICAgKVxuXG4gICAgLy8g5qWt5YuZ44K/44Kk44OX5Yil44Gu6ZuG6KiIXG4gICAgY29uc3QgdHlwZVN1bW1hcnkgPSBhd2FpdCBkYi5hbGwoXG4gICAgICBgXG4gICAgICBTRUxFQ1QgXG4gICAgICAgIHoudHlwZSwgXG4gICAgICAgIENPVU5UKHoua2V5SUQpIGFzIHRhc2tDb3VudCxcbiAgICAgICAgU1VNKChqdWxpYW5kYXkoei5lbmREYXRlVGltZSkgLSBqdWxpYW5kYXkoei5zdGFydERhdGVUaW1lKSkgKiAyNCkgYXMgdG90YWxIb3Vyc1xuICAgICAgRlJPTSBcbiAgICAgICAgbWFpbl9aaXNzZWtpIHpcbiAgICAgIFdIRVJFIFxuICAgICAgICB6LnN0YXJ0RGF0ZVRpbWUgPj0gPyBBTkQgXG4gICAgICAgIHouc3RhcnREYXRlVGltZSA8ID9cbiAgICAgIEdST1VQIEJZIFxuICAgICAgICB6LnR5cGVcbiAgICAgIE9SREVSIEJZIFxuICAgICAgICB0b3RhbEhvdXJzIERFU0NcbiAgICAgIGAsXG4gICAgICBbc3RhcnREYXRlLCBlbmREYXRlXVxuICAgIClcblxuICAgIHJldHVybiB7XG4gICAgICBwcm9qZWN0U3VtbWFyeSxcbiAgICAgIHR5cGVTdW1tYXJ5XG4gICAgfVxuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGRiLmNsb3NlKClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlcih1c2VySWQ6IHN0cmluZykge1xuICBjb25zdCBkYiA9IGF3YWl0IGdldERiQ29ubmVjdGlvbigpXG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGRiLmdldChgXG4gICAgICBTRUxFQ1QgXG4gICAgICAgIHVzZXJfaWQsXG4gICAgICAgIG5hbWVfamFwYW5lc2UgYXMgbmFtZSxcbiAgICAgICAgc3lva3VpIGFzIHBvc2l0aW9uLFxuICAgICAgICBidW1vbiBhcyBkZXBhcnRtZW50LFxuICAgICAgICBzaXRzdSBhcyBzZWN0aW9uLFxuICAgICAgICBrYSBhcyB0ZWFtLFxuICAgICAgICBtYWlsIGFzIGVtYWlsLFxuICAgICAgICBURUxfbmFpc2VuIGFzIHRlbE5haXNlbixcbiAgICAgICAgVEVMIGFzIHRlbEdhaXNlbixcbiAgICAgICAgY29tcGFueSxcbiAgICAgICAgbmFtZV9lbmdsaXNoLFxuICAgICAgICBuYW1lX3lvbWksXG4gICAgICAgIGluX3llYXIsXG4gICAgICAgIEtlbmdlbiBhcyBhdXRob3JpdHlcbiAgICAgIEZST00gYWxsX3VzZXJcbiAgICAgIFdIRVJFIHVzZXJfaWQgPSA/XG4gICAgYCwgW3VzZXJJZF0pXG5cbiAgICByZXR1cm4gdXNlclxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCLjg6bjg7zjgrbjg7zmg4XloLHjga7lj5blvpfkuK3jgavjgqjjg6njg7zjgYznmbrnlJ/jgZfjgb7jgZfjgZ86XCIsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzcWxpdGUzIiwib3BlbiIsInBhdGgiLCJmcyIsIkRCX1BBVEgiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsImdldERiQ29ubmVjdGlvbiIsImRiTmFtZSIsImRhdGFEaXIiLCJleGlzdHNTeW5jIiwibWtkaXJTeW5jIiwicmVjdXJzaXZlIiwiZGJQYXRoIiwiZGIiLCJmaWxlbmFtZSIsImRyaXZlciIsIkRhdGFiYXNlIiwicnVuIiwid2l0aFRyYW5zYWN0aW9uIiwiY2FsbGJhY2siLCJyZXN1bHQiLCJlcnJvciIsImNsb3NlIiwiZ2V0RW1wbG95ZWVzIiwiYWxsIiwiZ2V0UHJvamVjdHMiLCJnZXRBY3Rpdml0eVR5cGVzIiwiZ2V0Q3VycmVudFVzZXJJZCIsInNldHRpbmciLCJnZXQiLCJ2YWx1ZSIsImdldEN1cnJlbnRVc2VyIiwidXNlcklkIiwidXNlciIsInNldEN1cnJlbnRVc2VySWQiLCJnZXRBY2hpZXZlbWVudHNCeU1vbnRoIiwieWVhciIsIm1vbnRoIiwic3RhcnREYXRlIiwidG9TdHJpbmciLCJwYWRTdGFydCIsIm5leHRNb250aCIsIm5leHRZZWFyIiwiZW5kRGF0ZSIsImdldEFjaGlldmVtZW50c0J5V2VlayIsIndlZWsiLCJnZXRXZWVrRGF0ZXMiLCJzdGFydERhdGVTdHIiLCJmb3JtYXREYXRlIiwiZW5kRGF0ZVN0ciIsIkRhdGUiLCJnZXRUaW1lIiwiY3VycmVudFVzZXJJZCIsInJlc3VsdHMiLCJhZGRBY2hpZXZlbWVudCIsImFjaGlldmVtZW50IiwiY29sdW1ucyIsIk9iamVjdCIsImtleXMiLCJwbGFjZWhvbGRlcnMiLCJtYXAiLCJ2YWx1ZXMiLCJrZXlJRCIsInVwZGF0ZUFjaGlldmVtZW50Iiwic2V0Q2xhdXNlIiwia2V5IiwiY2hhbmdlcyIsImRlbGV0ZUFjaGlldmVtZW50IiwiZ2V0VXNlclByb2plY3RzIiwidXNlcklEIiwicHJvamVjdENvZGUiLCJxdWVyeSIsInBhcmFtcyIsInB1c2giLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwiZ2V0UHJvamVjdEVxdWlwbWVudE51bWJlcnMiLCJlcXVpcG1lbnROdW1iZXJzIiwic3BsaXQiLCJpdGVtIiwidHJpbSIsImdldFByb2plY3RQdXJjaGFzZUl0ZW1zIiwicHJvamVjdElkIiwiZXF1aXBtZW50TnVtYmVyIiwiYWRkVXNlclByb2plY3QiLCJyb2xlIiwidG9kYXkiLCJ0b0lTT1N0cmluZyIsImV4aXN0aW5nTWVtYmVyIiwiYWRkUHJvamVjdERldGFpbHMiLCJwcm9qZWN0RGV0YWlscyIsIkFycmF5IiwiaXNBcnJheSIsInByb2plY3ROdW1iZXIiLCJhZGRQcm9qZWN0UHVyY2hhc2VJdGVtIiwicHVyY2hhc2VJdGVtIiwic2VxdWVuY2VOdW1iZXIiLCJuZXh0U2VxIiwiZ2V0TmV4dFB1cmNoYXNlSXRlbVNlcXVlbmNlIiwicHJvamVjdF9pZCIsIm1heFNlcSIsImZpcnN0RGF5T2ZZZWFyIiwiZGF5c09mZnNldCIsImdldERheSIsImZpcnN0V2Vla0RheSIsInNldERhdGUiLCJnZXREYXRlIiwiZGF0ZSIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXRUYWJsZUNvbHVtbnMiLCJ0YWJsZU5hbWUiLCJnZXRBY3Rpdml0eVR5cGVDb2x1bW5zIiwiY29sdW1uTmFtZU1hcCIsInR5cGVDb2RlIiwidHlwZU5hbWUiLCJkZXNjcmlwdGlvbiIsImNhdGVnb3J5Iiwic3ViQ2F0ZWdvcnkiLCJkaXNwbGF5T3JkZXIiLCJjb2xvciIsImlzQWN0aXZlIiwiZXhjbHVkZWRDb2x1bW5zIiwiZmlsdGVyIiwiY29sIiwiaW5jbHVkZXMiLCJuYW1lIiwiaWQiLCJkYXRhVHlwZSIsInR5cGUiLCJ2aXNpYmxlIiwiYWRkQWN0aXZpdHlUeXBlIiwiYWN0aXZpdHlUeXBlIiwidXBkYXRlQWN0aXZpdHlUeXBlIiwidXBkYXRlRGF0YSIsImRlbGV0ZUFjdGl2aXR5VHlwZSIsImdldFByb2plY3RTdW1tYXJ5QnlNb250aCIsInByb2plY3RTdW1tYXJ5IiwidHlwZVN1bW1hcnkiLCJnZXRVc2VyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/db_utils.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/sqlite"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&page=%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fachievements%2Fweek%2F%5Byear%5D%2F%5Bweek%5D%2Froute.ts&appDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5CDY0330.ENG%5CDesktop%5Cproject_giji%5C20250526%5CPMESYSTEM&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();